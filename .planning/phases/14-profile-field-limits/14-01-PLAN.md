---
phase: 14-profile-field-limits
plan: 01
type: execute
---

<objective>
Add character limits to profile fields (display name, username, bio) with subtle visual feedback.

Purpose: Prevent data overflow while giving users clear, non-intrusive feedback about field limits.
Output: Enhanced Input component with maxLength enforcement, character counter on focus, and shake animation when limit reached.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-profile-field-limits/14-CONTEXT.md

# Source files:

@src/components/Input.js
@src/screens/ProfileSetupScreen.js

**Character limits (from CONTEXT.md):**

- Display name: 24 characters
- Username: 24 characters
- Bio: 240 characters

**Behavior requirements:**

- Counter appears only when field is focused ("12/24" style)
- Hard stop at limit - can't type more characters
- Subtle shake animation when trying to type past limit
- Counter disappears when field loses focus
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance Input component with character limit features</name>
  <files>src/components/Input.js</files>
  <action>
Add three new props to Input component:
1. `maxLength` (number) - Maximum characters allowed
2. `showCharacterCount` (boolean, default false) - Whether to show counter

When maxLength is set and showCharacterCount is true:

- Track focus state with useState
- Show character counter below input only when focused ("12/24" format)
- Counter positioned at bottom-right of container, subtle gray text
- Use TextInput's built-in maxLength prop for hard enforcement

For shake animation:

- Use Animated API (Animated.View wrapping input)
- Track when user tries to type at max length (compare previous value length)
- Trigger quick horizontal shake (translateX: 0 → 4 → -4 → 4 → 0 over ~200ms)
- Use Animated.sequence with timing for crisp shake feel

Style the counter:

- Font size 12, color colors.text.tertiary
- Position below input, right-aligned
- Only visible when input is focused AND maxLength is set

Do NOT change existing behavior when maxLength is not provided (backwards compatible).
</action>
<verify>
In Input.js:

- maxLength prop is accepted and passed to TextInput
- showCharacterCount prop controls counter visibility
- Counter shows "X/Y" format only when focused
- Shake animation triggers when typing at max length
  </verify>
  <done>
  Input component accepts maxLength and showCharacterCount props. Counter appears on focus with "X/Y" format. Shake animation fires when at limit. Existing Input usage unchanged.
  </done>
  </task>

<task type="auto">
  <name>Task 2: Apply character limits to ProfileSetupScreen fields</name>
  <files>src/screens/ProfileSetupScreen.js, src/utils/validation.js</files>
  <action>
Update all three Input fields in ProfileSetupScreen:

1. Display Name Input:
   - Add maxLength={24}
   - Add showCharacterCount={true}

2. Username Input:
   - Add maxLength={24}
   - Add showCharacterCount={true}

3. Bio Input:
   - Add maxLength={240}
   - Add showCharacterCount={true}

Update validation.js validateLength function calls in ProfileSetupScreen:

- Display name: validateLength(trimmedDisplayName, 2, 24, 'Display name')
- Bio: validateLength(bio.trim(), 1, 240, 'Bio')

This ensures both client-side enforcement (maxLength) and validation alignment (validateLength).
</action>
<verify>

1. Open app, navigate to profile setup
2. Focus on display name - see counter appear ("0/24")
3. Type to 24 chars - observe shake when trying to exceed
4. Unfocus - counter disappears
5. Repeat for username (24) and bio (240)
   </verify>
   <done>
   All three profile fields enforce character limits with visible counters on focus and shake feedback at limit.
   </done>
   </task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Input component accepts maxLength and showCharacterCount props
- [ ] Character counter appears only when field is focused
- [ ] Counter format is "X/Y" (current/max)
- [ ] Shake animation triggers when trying to type past limit
- [ ] Display name limited to 24 characters
- [ ] Username limited to 24 characters
- [ ] Bio limited to 240 characters
- [ ] Existing Input usage (without maxLength) unchanged
- [ ] `npm run lint` passes
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript/lint errors introduced
- Character limits enforced with visual feedback
- Backwards compatible - Input without maxLength works as before
  </success_criteria>

<output>
After completion, create `.planning/phases/14-profile-field-limits/14-01-SUMMARY.md`
</output>
