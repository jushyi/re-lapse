---
phase: 38-notification-ui-polish
plan: 38-01-FIX
type: fix
---

<objective>
Fix 1 UAT issue from plan 38-01.

Source: 38-01-ISSUES.md
Priority: 0 critical, 1 major, 0 minor
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md

**Issues being fixed:**
@.planning/phases/38-notification-ui-polish/38-01-ISSUES.md

**Original plan for reference:**
@.planning/phases/38-notification-ui-polish/38-01-PLAN.md

**Current implementation:**
@src/components/InAppNotificationBanner.js
@src/styles/InAppNotificationBanner.styles.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix UAT-001 — Banner safe area positioning</name>
  <files>src/components/InAppNotificationBanner.js, src/styles/InAppNotificationBanner.styles.js</files>
  <action>
The banner currently uses `SafeAreaView edges={['top']}` inside an `Animated.View` that slides from `translateY: -120` to `translateY: 0`. The `outerContainer` style has `position: absolute, top: 0`. When the animation completes at translateY=0, the container starts at the physical top of the screen. The SafeAreaView adds internal padding but the banner still overlaps the notch/status bar area.

**Fix approach:** Replace `SafeAreaView` with `useSafeAreaInsets()` hook to get the top inset value, then use it as explicit `paddingTop` on the outerContainer. This ensures the banner content sits below the notch while the slide animation still works correctly.

**InAppNotificationBanner.js changes:**

1. Replace `import { SafeAreaView } from 'react-native-safe-area-context'` with `import { useSafeAreaInsets } from 'react-native-safe-area-context'`
2. Inside the component, call `const insets = useSafeAreaInsets();`
3. Remove the `<SafeAreaView edges={['top']}>` wrapper around the TouchableOpacity
4. Apply `paddingTop: insets.top` directly to the `outerContainer` style via inline style: `style={[styles.outerContainer, { transform: [{ translateY }], paddingTop: insets.top }]}`
5. Adjust `SLIDE_START` to be more negative if needed (e.g., -160) to account for the added top padding ensuring the banner is fully off-screen when hidden

**InAppNotificationBanner.styles.js changes:**

- No changes needed — the paddingTop is applied dynamically via inline style since it depends on the device's safe area insets.

Do NOT change any animation logic, auto-dismiss behavior, swipe-up handling, or tap navigation. Only fix the safe area positioning.
</action>
<verify>

1. InAppNotificationBanner.js uses useSafeAreaInsets() instead of SafeAreaView
2. paddingTop: insets.top is applied to the outerContainer
3. No SafeAreaView import remains in the file
4. Animation constants (SLIDE_START, SLIDE_END) still allow banner to fully hide off-screen
   </verify>
   <done>Banner respects iOS safe area insets via useSafeAreaInsets(), content renders below the notch and status bar icons. Animation still slides from off-screen to visible position.</done>
   </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Fixed banner safe area positioning — banner now uses useSafeAreaInsets() to ensure content sits below the notch and status bar</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Open app on iOS device with notch (iPhone X or later)
    3. Trigger a push notification while app is in foreground
    4. Verify: Banner content (avatar, title, body) sits BELOW the notch and status bar icons
    5. Verify: Banner still slides down smoothly from off-screen
    6. Verify: Banner still auto-dismisses after ~4 seconds
    7. Verify: Swiping up still dismisses the banner
  </how-to-verify>
  <resume-signal>Type "approved" or describe remaining issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Banner content renders below the iOS notch and status bar
- [ ] Slide animation still works (slides from off-screen to visible)
- [ ] Auto-dismiss and swipe-up dismiss still function
- [ ] No lint errors introduced
</verification>

<success_criteria>

- UAT-001 resolved: Banner respects iOS safe area insets
- All existing banner functionality preserved (animation, auto-dismiss, swipe, tap-navigate)
- Ready for re-verification
  </success_criteria>

<output>
After completion, create `.planning/phases/38-notification-ui-polish/38-01-FIX-SUMMARY.md`
</output>
