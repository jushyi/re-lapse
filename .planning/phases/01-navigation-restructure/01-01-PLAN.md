---
phase: 01-navigation-restructure
plan: 01
type: execute
---

<objective>
Remove Darkroom tab from bottom navigation and add darkroom button to CameraScreen.

Purpose: Prepare the navigation structure for Phase 2's press-and-hold darkroom bottom sheet by moving darkroom access from tab bar to camera screen.
Output: Updated navigation with 4 tabs (Feed, Camera, Friends, Profile) and darkroom button on CameraScreen.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/navigation/AppNavigator.js
@src/screens/CameraScreen.js
@src/services/firebase/photoService.js

**Current navigation structure:**
- MainTabNavigator has 5 tabs: Feed, Camera, Friends, Darkroom, Profile
- DarkroomIcon component already implements badge count logic (lines 205-237)
- Darkroom count polling exists in MainTabNavigator (lines 52-70)

**Established patterns:**
- React Navigation (@react-navigation/bottom-tabs, @react-navigation/native-stack)
- Tab icons are SVG-based components
- Badge styling uses iOS-style red circle (backgroundColor: '#FF3B30')
- Photo count retrieved via getDevelopingPhotoCount(userId) from photoService

**Key insight:**
Badge count logic and icon component already exist in AppNavigator.js. Reuse this pattern for CameraScreen button without creating duplicate logic.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove Darkroom tab from MainTabNavigator</name>
  <files>src/navigation/AppNavigator.js</files>
  <action>
Remove the Darkroom Tab.Screen from MainTabNavigator (lines 110-116). Keep the darkroom count state management (lines 52-70) as it will be passed to CameraScreen via navigation params or context in Phase 2. Do NOT remove DarkroomIcon component yet - it will be referenced in Task 2 for badge styling consistency. Update MainTabNavigator to have 4 tabs: Feed, Camera, Friends, Profile (in that order).
  </action>
  <verify>npm start succeeds, app renders with 4 tabs instead of 5, Darkroom tab no longer visible</verify>
  <done>MainTabNavigator has exactly 4 Tab.Screen components, app builds without errors, bottom nav shows Feed/Camera/Friends/Profile only</done>
</task>

<task type="auto">
  <name>Task 2: Add darkroom button to CameraScreen with badge count</name>
  <files>src/screens/CameraScreen.js</files>
  <action>
Add darkroom button to CameraScreen's top-right corner (opposite flash control):

1. Import getDevelopingPhotoCount from '../services/firebase/photoService'
2. Import useNavigation hook from '@react-navigation/native'
3. Add state: const [darkroomCount, setDarkroomCount] = useState(0)
4. Add useEffect to load count on mount: getDevelopingPhotoCount(user.uid), poll every 30s (match MainTabNavigator pattern)
5. Create DarkroomButton component at bottom of file (before styles):
   - TouchableOpacity with onPress={() => navigation.navigate('Darkroom')}
   - DarkroomIcon SVG (moon shape - copy from AppNavigator.js lines 207-215)
   - Badge overlay if count > 0 (copy badge logic from AppNavigator.js lines 216-235)
   - Disabled state styling when count === 0 (opacity: 0.4)
6. Position button in top-right: position: 'absolute', top: 60, right: 20
7. Place button AFTER camera controls in JSX (below flash button)

Use exact badge styling from AppNavigator.js DarkroomIcon for consistency: #FF3B30 background, white text, 10px font, 18px height. Do NOT create new badge logic - copy the existing pattern.
  </action>
  <verify>npm start succeeds, darkroom button visible in top-right of CameraScreen, badge shows count, tapping button navigates to Darkroom tab, button is semi-transparent when count is 0</verify>
  <done>CameraScreen has darkroom button with badge count, button navigates to Darkroom, disabled state shows when count === 0, badge styling matches existing DarkroomIcon</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] npm start succeeds without errors
- [ ] Bottom navigation has 4 tabs: Feed, Camera, Friends, Profile
- [ ] Darkroom tab no longer present in bottom nav
- [ ] CameraScreen shows darkroom button in top-right corner
- [ ] Darkroom button displays badge count when photos developing
- [ ] Tapping darkroom button navigates to Darkroom screen
- [ ] Darkroom button shows disabled state (semi-transparent) when count is 0
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript/JavaScript errors
- Navigation structure matches Phase 2 requirements (darkroom access from camera, not tab bar)
- Badge count logic consistent between original DarkroomIcon and new CameraScreen button
</success_criteria>

<output>
After completion, create `.planning/phases/01-navigation-restructure/01-01-SUMMARY.md`:

# Phase 1 Plan 1: Navigation Restructure Summary

**Removed Darkroom tab from bottom nav and added darkroom button to CameraScreen**

## Accomplishments

- MainTabNavigator reduced from 5 tabs to 4 (removed Darkroom)
- CameraScreen now has darkroom button with badge count in top-right corner
- Badge count logic polling every 30s (matches original pattern)
- Disabled state shows when no photos developing (semi-transparent)
- Navigation to Darkroom screen works from camera button

## Files Created/Modified

- `src/navigation/AppNavigator.js` - Removed Darkroom Tab.Screen from MainTabNavigator
- `src/screens/CameraScreen.js` - Added darkroom button with badge count, polling logic, navigation

## Decisions Made

- Reused existing badge styling from DarkroomIcon for consistency (#FF3B30, white text, 10px font)
- Matched polling interval (30s) from MainTabNavigator for count updates
- Positioned button in top-right corner (opposite flash control) for symmetry
- Used opacity: 0.4 for disabled state to indicate button is non-functional when count is 0

## Issues Encountered

None

## Next Phase Readiness

Phase 2 ready to begin: Darkroom access now triggered from CameraScreen button. Next phase will replace button tap with press-and-hold reveal UI.

**Dependencies met:**
- Darkroom button positioned for Phase 2's bottom sheet overlay
- Badge count logic in place for progress bar integration
- DarkroomScreen navigation path established
</output>
