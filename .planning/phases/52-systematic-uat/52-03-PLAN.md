---
phase: 52-systematic-uat
plan: 03
type: execute
---

<objective>
Test authentication flows and account management features — sign out, sign in, delete account.

Purpose: Verify users can reliably authenticate, re-authenticate, and delete their accounts without data loss or security issues.
Output: Auth flows verified, account deletion tested, edge cases covered.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/52-systematic-uat/52-CONTEXT.md

@src/screens/PhoneInputScreen.js
@src/screens/VerificationScreen.js
@src/screens/SettingsScreen.js
@src/screens/DeleteAccountScreen.js
@src/services/firebase/phoneAuthService.js
@src/context/AuthContext.js

**Testing device:** Physical iPhone
**Firebase environment:** Dev environment
**Starting state:** Logged in from Plan 52-01

**Features to test:**

- Sign out → Sign in flow
- Phone auth re-verification
- Delete account flow (with reversal confirmation)
- Edge cases: wrong code, resend code, rapid tapping
  </context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Sign out and sign in flow</what-built>
  <how-to-verify>
    **Step 1: Sign Out**
    1. Go to Profile tab → Settings (gear icon)
    2. Scroll to bottom → tap "Sign Out"
    3. Confirm alert appears asking "Are you sure?"
    4. Tap "Sign Out"
    5. Verify app returns to PhoneInputScreen

    **Expected:**
    - Confirmation alert appears (prevents accidental sign out)
    - After sign out, no profile data visible
    - PhoneInputScreen shows clean state

    **Step 2: Sign In**
    1. Enter same phone number from Plan 52-01
    2. Tap "Send Code"
    3. Enter received 6-digit code
    4. Verify app navigates to MainTabs (NOT onboarding)
    5. Verify profile data is intact (username, display name, photo)

    **Expected:**
    - SMS arrives within 30 seconds
    - Code accepted, navigates to MainTabs directly
    - No forced re-onboarding for existing users
    - All profile data preserved

    **Step 3: Edge Cases**
    1. Sign out again
    2. Enter phone number, tap "Send Code"
    3. Enter WRONG 6-digit code (e.g., 000000)
    4. Verify error message appears
    5. Tap "Resend Code"
    6. Verify new SMS arrives
    7. Enter correct code
    8. Verify sign in succeeds

    **Expected:**
    - Invalid code shows clear error, doesn't crash
    - "Resend Code" button appears after initial send
    - Multiple SMS codes can be sent without issues
    - Latest code works even if previous codes exist

  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe any issues</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Delete account flow</what-built>
  <how-to-verify>
    **Step 1: Navigate to Delete Account**
    1. Go to Profile → Settings → Account
    2. Scroll to bottom → tap "Delete Account"
    3. Verify DeleteAccountScreen appears with warning text

    **Expected:**
    - Clear warning about permanent deletion
    - Lists what will be deleted (photos, albums, friendships)

    **Step 2: Test Reversal Confirmation**
    1. Type "DELETE" in the confirmation text field
    2. Tap "Delete My Account"
    3. Verify final confirmation alert appears
    4. Tap "Cancel" (do NOT delete)
    5. Verify still on DeleteAccountScreen, account intact

    **Expected:**
    - Typing "DELETE" enables delete button
    - Final confirmation alert prevents accidental deletion
    - Cancel preserves account fully

    **Step 3: Test Form Validation**
    1. Clear text field
    2. Try typing "delete" (lowercase)
    3. Verify delete button remains disabled
    4. Try typing "DELE" (incomplete)
    5. Verify delete button remains disabled
    6. Type "DELETE" (correct)
    7. Verify delete button enables

    **Expected:**
    - Exact match "DELETE" required (case-sensitive)
    - Button state updates immediately on text change

    **Step 4: Verify No Deletion Occurred**
    1. Tap back/cancel to exit DeleteAccountScreen
    2. Go to Profile → verify profile still exists
    3. Go to Feed → verify can still see photos

    **Expected:**
    - Account fully intact after canceling
    - All data still accessible

  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe any issues. DO NOT actually delete the account — we need it for subsequent tests.</resume-signal>
</task>

<task type="auto">
  <name>Fix any issues found during auth testing</name>
  <files>Determined by issues found</files>
  <action>If issues found (e.g., sign out doesn't clear state, wrong code crashes, delete button validation broken), investigate and fix inline. Read relevant auth service/context files, diagnose, fix, have user re-test. Escalate complex issues to GitHub.</action>
  <verify>User confirms issue is resolved</verify>
  <done>All reported issues fixed or escalated</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Sign out → Sign in works correctly
- [ ] Returning users skip onboarding
- [ ] Wrong code handling works
- [ ] Resend code works
- [ ] Delete account flow requires "DELETE" confirmation
- [ ] Cancel preserves account
- [ ] No issues left unresolved
</verification>

<success_criteria>

- Sign out clears session and returns to phone input
- Sign in restores session without re-onboarding
- Invalid code shows error, doesn't crash
- Resend code delivers new SMS
- Delete account requires exact "DELETE" text and final confirmation
- Account NOT deleted during testing (needed for subsequent plans)
  </success_criteria>

<output>
After completion, create `.planning/phases/52-systematic-uat/52-03-SUMMARY.md`:

# Plan 52-03 Summary: Auth & Account Management

**[One-line summary of test results]**

## Test Results

**Sign Out/In:**

- Sign out: [PASS/FAIL + notes]
- Sign in: [PASS/FAIL + notes]
- Profile data preservation: [PASS/FAIL + notes]

**Edge Cases:**

- Wrong code handling: [PASS/FAIL + notes]
- Resend code: [PASS/FAIL + notes]

**Delete Account:**

- Navigation: [PASS/FAIL + notes]
- Validation: [PASS/FAIL + notes]
- Confirmation flow: [PASS/FAIL + notes]
- Cancel preservation: [PASS/FAIL + notes]

## Issues Found

[List any bugs or issues]

## Inline Fixes Applied

[List fixes or "None"]

## Next Step

Ready for 52-04-PLAN.md (Profile & Settings)
</output>
