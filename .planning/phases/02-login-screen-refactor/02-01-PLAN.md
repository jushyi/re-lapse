---
phase: 02-login-screen-refactor
plan: 01
type: execute
---

<objective>
Refactor the login/verification flow to use Phase 1 shared components and ensure dark theme consistency.

Purpose: Complete the auth screen dark theme transformation by integrating AuthCodeInput and standardizing color usage.
Output: VerificationScreen using AuthCodeInput component, all auth screens using colors.js constants consistently.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Phase 1 Components (ready to use):**
@src/components/Button.js - Dark theme button with variants
@src/components/Input.js - Dark theme input with label/error states
@src/components/AuthCodeInput.js - 6-digit verification code input with individual boxes

**Files to modify:**
@src/screens/VerificationScreen.js - Needs AuthCodeInput integration, color cleanup
@src/screens/PhoneInputScreen.js - Already dark-themed, verify consistency

**Color constants:**
@src/constants/colors.js - All colors.status.danger, colors.text.\*, etc.

**Tech stack available:** React Native, Expo, Firebase Auth (phone)
**Established patterns:** colors.js constants, shared components via barrel export
**Constraining decisions:**

- Phase 1: Use colors.js constants throughout components
- Phase 1: AuthCodeInput uses hidden TextInput pattern for keyboard/autofill support
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Integrate AuthCodeInput into VerificationScreen</name>
  <files>src/screens/VerificationScreen.js</files>
  <action>
  Replace the manual TextInput code input with the AuthCodeInput component:

1. Import AuthCodeInput from '../components'
2. Remove the inputRef and manual TextInput
3. Replace with AuthCodeInput component:
   - value={code}
   - onChange={setCode} (will clear error via existing handleCodeChange logic, adapt as needed)
   - onComplete={handleVerify} (auto-submit when 6 digits entered)
   - error={!!error}
   - disabled={loading || retryDelay > 0}
   - autoFocus={true}
4. Remove handleCodeChange function (AuthCodeInput handles numeric filtering internally)
5. Adapt useEffect auto-submit logic - may be redundant now since AuthCodeInput calls onComplete
6. Replace hardcoded '#FF4444' with colors.status.danger in:
   - codeInputError style (line ~325)
   - errorText style (line ~334)
7. Remove unused codeInput styles that are replaced by AuthCodeInput
8. Update the code clearing logic on error: setCode('') remains, but no need to refocus

Keep existing logic:

- Shake animation on error (wrap AuthCodeInput in Animated.View)
- Retry delay timer
- Resend code flow
- Back/Change number navigation

Avoid: Removing any existing UX features (shake, retry delay, resend timer).
</action>
<verify>

- npm run lint passes without errors
- AuthCodeInput import present, no unused imports
- No hardcoded '#FF4444' in file
- grep -c "colors.status.danger" src/screens/VerificationScreen.js returns 2+
  </verify>
  <done>
- VerificationScreen uses AuthCodeInput component
- All error colors use colors.status.danger constant
- No TypeScript/ESLint errors
- Shake animation still wraps the code input
  </done>
  </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Refactored VerificationScreen with AuthCodeInput component and consistent dark theme styling</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Open app on iOS device/simulator
    3. On PhoneInputScreen:
       - Verify dark background (#0F0F0F)
       - Verify white text on dark
       - Verify country selector has dark theme (gray background, subtle border)
       - Verify phone input uses dark Input component styling
       - Verify "Send Code" button matches dark theme
       - Enter a test phone number and tap Send Code
    4. On VerificationScreen:
       - Verify 6 individual digit boxes appear (not single text input)
       - Verify boxes have dark gray background (#1A1A1A)
       - Verify active box has white border highlight
       - Verify entered digits appear white
       - Enter wrong code - verify red error styling on all boxes
       - Verify shake animation triggers on error
       - Verify error text is red (colors.status.danger)
       - Verify "Retry in Xs" countdown appears
       - Verify resend timer works (60s countdown)
    5. Overall: Both screens should match Camera/Feed/Darkroom dark aesthetic
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] npm run lint passes without errors
- [ ] No hardcoded color values in VerificationScreen.js
- [ ] AuthCodeInput properly imported and used
- [ ] Visual verification of both auth screens passes
- [ ] Dark theme consistent with Camera/Feed/Darkroom screens
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- VerificationScreen uses AuthCodeInput component
- All colors use colors.js constants
- Human verification of dark theme consistency approved
- Phase 2 complete
  </success_criteria>

<output>
After completion, create `.planning/phases/02-login-screen-refactor/02-01-SUMMARY.md`:

# Phase 2 Plan 1: Login Screen Refactor Summary

**[One-liner describing what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

[Ready for Phase 3: Signup Flow Refactor]
</output>
