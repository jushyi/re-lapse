---
phase: 05-camera-icon-redesign
plan: 01
type: execute
---

<objective>
Restructure CameraScreen layout with absolute positioning and update all camera control icons to match the bottom navigation SVG design system.

Purpose: Create a polished, visually consistent camera interface with proper layout hierarchy (camera area, floating controls, footer bar) and cohesive icon design.
Output: Refactored CameraScreen with absolute positioning layout, solid footer bar, floating control buttons, and consistent SVG icons for flash/flip camera controls.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-camera-icon-redesign/05-CONTEXT.md

# Prior phase context
@.planning/phases/04-success-return-flow/04-02-SUMMARY.md

# Key source files
@src/screens/CameraScreen.js
@src/navigation/AppNavigator.js

**Tech stack available:**
- react-native-svg (already imported and used)
- Dimensions API for screen calculations
- Expo SDK 54.x camera system

**Established patterns:**
- SVG icons with 24x24 viewBox, 1.5 strokeWidth, round strokeLinecap
- Consistent icon color passed via props
- Bottom nav icons as reference: CameraIcon, DarkroomIcon, ProfileIcon, FeedIcon, FriendsIcon

**Layout requirements from CONTEXT.md:**
- Camera area: Upper 2/3 of screen (live camera feed)
- Footer area: Lower 1/3 with solid color bar background
- Floating controls: Flash (bottom left) and flip camera (bottom right), 8-12px above footer edge
- Footer controls: Capture button (center), Darkroom button (left of capture), Debug button (right of capture)

**Icons to redesign:**
- Flash icon: Currently emoji (‚ö°Ô∏è), needs SVG matching nav icon style
- Flip camera icon: Currently emoji (üîÑ), needs SVG matching nav icon style
- Debug button: Currently emoji (üåô), can keep as temporary marker or use simple SVG
</context>

<tasks>

<task type="auto">
  <name>Task 1: Restructure CameraScreen layout with absolute positioning</name>
  <files>src/screens/CameraScreen.js</files>
  <action>
Refactor CameraScreen to use absolute positioning (required because CameraView doesn't support children well):

1. **Remove button children from CameraView** - Move all controls outside CameraView

2. **Create layout structure with absolute positioning:**
   - Container (flex: 1, black background)
   - CameraView (absolute, top: 0, left: 0, right: 0, height: ~67% of screen)
   - Footer bar (absolute, bottom: 0, left: 0, right: 0, height: ~33% of screen, solid dark background like rgba(0,0,0,0.9) or #1A1A1A)
   - Floating controls overlay (absolute positioning for flash and flip camera buttons)

3. **Position floating controls:**
   - Flash button: absolute, positioned at bottom left of camera area, 10px above footer edge, 24px from left
   - Flip camera button: absolute, positioned at bottom right of camera area, 10px above footer edge, 24px from right
   - Both buttons get semi-transparent backgrounds (rgba(0,0,0,0.5)) with rounded corners

4. **Position footer controls:**
   - Capture button: centered in footer
   - Darkroom button: left of capture button (flexbox or absolute with calculated position)
   - Debug button: right of capture button (flexbox or absolute with calculated position)
   - Use flexDirection: 'row', justifyContent: 'center', alignItems: 'center' with gap for footer button layout

5. **Calculate dimensions:**
   - Use Dimensions.get('window') for screen height
   - FOOTER_HEIGHT = ~SCREEN_HEIGHT * 0.33 or fixed value like 200px
   - CAMERA_HEIGHT = SCREEN_HEIGHT - FOOTER_HEIGHT
   - Account for safe area (bottom inset) for capture button positioning

6. **Preserve existing functionality:**
   - Keep all button handlers (toggleFlash, toggleCameraFacing, takePicture, darkroom sheet)
   - Keep animated photo overlay and bottom sheet
   - Keep badge count on darkroom button
   - Maintain all state and useEffect hooks unchanged

**What to avoid:**
- Don't place children inside CameraView (causes issues with some expo-camera versions)
- Don't use flexbox for camera/footer split (use absolute positioning for precise control)
- Don't change any button functionality or state management - this is purely layout refactoring
  </action>
  <verify>
- App runs without errors: `npx expo start`, open in Expo Go
- Camera preview displays in upper portion of screen
- Footer bar is solid (not transparent) at bottom of screen
- Flash button is floating above footer on left side
- Flip camera button is floating above footer on right side
- Capture button is centered in footer
- Darkroom button is left of capture
- Debug button is right of capture
- All buttons remain functional (capture, flash toggle, flip camera, darkroom sheet)
  </verify>
  <done>
- CameraView has no button children
- Layout uses absolute positioning throughout
- Footer bar has solid background
- Floating controls positioned 8-12px above footer edge
- Footer controls centered with proper spacing
- All existing functionality preserved
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace emoji icons with SVG icons matching navigation design</name>
  <files>src/screens/CameraScreen.js</files>
  <action>
Create SVG icon components for flash and flip camera, following the exact style established in AppNavigator.js:

1. **Create FlashIcon component** (new component in CameraScreen.js):
   ```javascript
   const FlashIcon = ({ color = '#FFFFFF', mode = 'off' }) => (
     <Svg width="24" height="24" viewBox="0 0 24 24" fill="none">
       <Path
         d="M13 2L4.09 12.35a1 1 0 0 0 .77 1.65H11v6a1 1 0 0 0 1.84.54l8.91-10.35a1 1 0 0 0-.77-1.65H13V2z"
         stroke={color}
         strokeWidth="1.5"
         strokeLinecap="round"
         strokeLinejoin="round"
         fill={mode === 'on' ? color : 'none'}
       />
     </Svg>
   );
   ```
   - Use fill for 'on' mode (filled bolt), stroke-only for 'off' and 'auto'
   - Show "AUTO" label text below icon when mode is 'auto', no label for on/off

2. **Create FlipCameraIcon component** (new component in CameraScreen.js):
   ```javascript
   const FlipCameraIcon = ({ color = '#FFFFFF' }) => (
     <Svg width="24" height="24" viewBox="0 0 24 24" fill="none">
       <Path
         d="M16 3h5v5"
         stroke={color}
         strokeWidth="1.5"
         strokeLinecap="round"
         strokeLinejoin="round"
       />
       <Path
         d="M4 20L21 3"
         stroke={color}
         strokeWidth="1.5"
         strokeLinecap="round"
         strokeLinejoin="round"
       />
       <Path
         d="M21 16v5h-5"
         stroke={color}
         strokeWidth="1.5"
         strokeLinecap="round"
         strokeLinejoin="round"
       />
       <Path
         d="M15 15l6 6"
         stroke={color}
         strokeWidth="1.5"
         strokeLinecap="round"
         strokeLinejoin="round"
       />
       <Path
         d="M4 4l5 5"
         stroke={color}
         strokeWidth="1.5"
         strokeLinecap="round"
         strokeLinejoin="round"
       />
     </Svg>
   );
   ```
   - Represents two arrows rotating/flipping (camera switch gesture)

3. **Update flash button to use FlashIcon:**
   - Replace `<Text style={styles.flashIcon}>{getFlashIcon()}</Text>` with `<FlashIcon color="#FFFFFF" mode={flash} />`
   - Keep flash label text ("OFF", "ON", "AUTO") below icon but only show for 'auto' mode
   - Style the label with smaller font (10-11px) and white color

4. **Update flip camera button to use FlipCameraIcon:**
   - Replace `<Text style={styles.controlIcon}>üîÑ</Text>` with `<FlipCameraIcon color="#FFFFFF" />`

5. **Update debug button:**
   - Keep emoji üåô for debug button (it's temporary and the purple background already distinguishes it)
   - Alternatively, use text "DBG" if cleaner

6. **Icon sizing consistency:**
   - All icons: 24x24 viewBox
   - strokeWidth: 1.5
   - strokeLinecap: "round"
   - strokeLinejoin: "round"
   - Color: #FFFFFF for active controls

7. **Remove unused styles:**
   - Remove flashIcon style (was for emoji)
   - Remove controlIcon style if no longer used
   - Keep flashLabel style for the "AUTO" text indicator

**What to avoid:**
- Don't use Text components for icons (use SVG only)
- Don't add new dependencies - react-native-svg is already imported
- Don't change button behavior or state - just the visual icons
  </action>
  <verify>
- Flash button shows lightning bolt SVG icon (filled when ON, outline when OFF/AUTO)
- "AUTO" label appears below flash icon only when flash mode is 'auto'
- Flip camera button shows rotation/flip arrows SVG icon
- All icons are white (#FFFFFF) and visually consistent with bottom nav icons
- Icons have same stroke weight (1.5) as bottom nav icons
- Button functionality unchanged (flash cycles off‚Üíon‚Üíauto, flip toggles front/back)
  </verify>
  <done>
- FlashIcon SVG component created with mode-based fill (on=filled, off/auto=outline)
- FlipCameraIcon SVG component created with rotation arrows
- Flash button uses FlashIcon with conditional "AUTO" label
- Flip camera button uses FlipCameraIcon
- All icons match bottom nav design system (24x24, 1.5 stroke, round caps)
- Debug button remains distinct (temporary placement)
- No emoji icons remain in camera controls
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete camera interface redesign with new layout and SVG icons</what-built>
  <how-to-verify>
    1. Run: `npx expo start` in the lapse-clone-app directory
    2. Open the app in Expo Go on your iPhone
    3. Navigate to the Camera tab
    4. Verify layout structure:
       - Camera preview fills upper ~2/3 of screen
       - Solid dark footer bar fills lower ~1/3 of screen
       - Flash icon (lightning bolt) floats above footer, bottom left corner of camera area
       - Flip camera icon (rotation arrows) floats above footer, bottom right corner of camera area
       - Capture button is centered in footer
       - Darkroom button (moon icon) is left of capture button
       - Debug button is right of capture button
    5. Test flash icon states:
       - Tap flash button - cycles through OFF (outline) ‚Üí ON (filled) ‚Üí AUTO (outline + "AUTO" label)
       - Icons are clean SVGs, no emojis
    6. Test flip camera:
       - Tap flip camera button - toggles between front/back camera
       - Icon is clean SVG with rotation arrows
    7. Test capture:
       - Tap capture button - takes photo with animation to darkroom
       - Badge count updates on darkroom button
    8. Test darkroom:
       - Tap darkroom button (when badge > 0) - opens bottom sheet
       - Press and hold to reveal photos - navigates to Darkroom screen
    9. Verify visual polish:
       - All icons are white (#FFFFFF)
       - Buttons have semi-transparent backgrounds
       - Footer bar is solid, not transparent
       - Overall layout feels clean and organized
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any layout or icon issues that need fixing</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] App starts without errors in Expo Go
- [ ] CameraScreen uses absolute positioning (no children in CameraView)
- [ ] Footer bar has solid dark background
- [ ] Floating controls positioned correctly above footer
- [ ] Footer controls (capture, darkroom, debug) properly spaced and centered
- [ ] FlashIcon SVG displays correctly in all three modes (off, on, auto)
- [ ] FlipCameraIcon SVG displays correctly
- [ ] All button functionality preserved (capture, flash, flip, darkroom)
- [ ] Icons match bottom nav design system (1.5 stroke, round caps, 24x24)
- [ ] No emoji icons remain in camera controls
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Layout restructured with absolute positioning
- SVG icons replace all emoji icons in camera controls
- Visual consistency achieved with bottom navigation icons
- Phase 5 complete - milestone complete
  </success_criteria>

<output>
After completion, create `.planning/phases/05-camera-icon-redesign/05-01-SUMMARY.md`:

# Phase 5 Plan 1: Camera Icon Redesign Summary

**[One-liner describing what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

Milestone complete. Camera/Darkroom UX refactor finished. All 5 phases completed.
</output>
