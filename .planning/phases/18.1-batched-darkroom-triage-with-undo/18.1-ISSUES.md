# UAT Issues: Phase 18.1

**Tested:** 2026-01-23 (re-tested after FIX-5)
**Source:** .planning/phases/18.1-batched-darkroom-triage-with-undo/18.1-FIX-5-SUMMARY.md
**Tester:** User via /gsd:verify-work

## Open Issues

None.

---

## Resolved Issues

### UAT-006: Card cascade animation snaps to position (FIX-5 regression) - RESOLVED

**Discovered:** 2026-01-23
**Phase/Plan:** 18.1 (post-FIX-5 verification)
**Severity:** Minor
**Feature:** Card cascade animation during triage
**Description:** Despite FIX-5 consolidating to single animation trigger (stackIndex useEffect) with 350ms timing animation, the card cascade still snaps to position instead of gliding smoothly. This is the same behavior observed in UAT-004 and UAT-005 - the fix did not resolve the issue.
**Expected:** Smooth 350ms glide motion when card transitions to front position
**Actual:** Card snaps/jumps instantly into position
**Root Cause:** When card becomes `isActive=true`, the `cardStyle` immediately switched from using `stackOffsetAnim` to `translateX/Y`. The cascade animation was running on `stackOffsetAnim` but being ignored because the style switched transforms.
**Resolution:** Added `isTransitioningToFront` shared value flag that keeps cardStyle using stackOffsetAnim during the 350ms transition animation. Flag clears to 0 via animation callback when transition completes, then cardStyle switches to translateX/Y for gesture handling.
**Fixed in:** 18.1-FIX-6-PLAN.md
**Commit:** 91652e6

---

### UAT-005: Card cascade animation still snaps abruptly - RESOLVED

**Discovered:** 2026-01-23
**Phase/Plan:** 18.1 (post-FIX-4 verification)
**Severity:** Minor
**Feature:** Card cascade animation during triage
**Description:** Despite 18.1-FIX-4 adjusting spring config (damping: 18, stiffness: 100) and adding 100ms delay, the card cascade animation still snaps abruptly instead of smooth gliding motion when the next card moves to front position. Root cause was race condition between cascading useEffect and stackIndex useEffect.
**Expected:** Smooth glide/settle motion when card transitions to front position
**Actual:** Card snaps abruptly into position
**Resolution:** Eliminated race condition by consolidating to single animation trigger (stackIndex useEffect only). Removed cascading prop, cascading useEffect, and onSwipeStart callback. Switched from spring to timing animation (350ms, ease-out) for predictable motion.
**Fixed in:** 18.1-FIX-5-PLAN.md
**Commit:** 33d79e1

---

### UAT-004: Card cascade animation snaps instead of smooth transition - RESOLVED

**Discovered:** 2026-01-23
**Phase/Plan:** 18.1-FIX-3 (verification testing)
**Severity:** Cosmetic
**Feature:** Card stack cascade animation during triage
**Description:** When swiping a card away, the next card (moving to front position) snaps into place abruptly instead of smoothly sliding/settling. Additionally, when a new 3rd card appears in the back of the stack, it appears abruptly rather than fading in smoothly.
**Expected:**
- Front card transition should be smooth slide/settle motion
- New back card should fade in smoothly
**Actual:**
- Front card snaps into final position (jarring)
- New 3rd card appears abruptly (jarring)
**Resolution:** Adjusted spring animation config (damping: 18, stiffness: 100) for smoother settling. Added 100ms delay for front card transition. Added 300ms fade-in animation for new cards entering visible stack at position 2.
**Fixed in:** 18.1-FIX-4-PLAN.md
**Commit:** `09b2a04`

---

### UAT-003: Black flash still visible during card transitions - RESOLVED

**Discovered:** 2026-01-23
**Phase/Plan:** 18.1-FIX-2 (verification testing)
**Severity:** Major
**Feature:** Card cascade animation during triage
**Description:** Despite 18.1-FIX-2 implementing hidden tracking (no array mutation) and cascade transition flag, black flash is still visible on every swipe. The flash is slightly better than before but still noticeable. Undo also has the same issue - image flashes black before the animation moves card backward.
**Expected:** Smooth cascade transition with no visual glitch
**Actual:** Black flash on every swipe (forward and undo), slightly reduced intensity vs before
**Resolution:** Migrated from React Native Image to expo-image with native caching (SDWebImage/Glide) and 200ms transition prop. Also added image prefetching for first 4 visible stack cards.
**Fixed in:** 18.1-FIX-3-PLAN.md
**Commit:** f747c6d

### UAT-002: Black flash persists when next card transitions to front position - PARTIALLY RESOLVED

**Discovered:** 2026-01-22
**Phase/Plan:** 18.1-FIX (regression or incomplete fix)
**Severity:** Blocker â†’ Major (downgraded after partial fix)
**Feature:** Card cascade animation during triage
**Description:** Despite UAT-001 fix in 18.1-FIX, black flash still occurs when swiping cards. The animation also feels clunky. User suggests this may be caused by removing cards from the array index - when the array updates, React re-renders cause the black flash.
**User Suggestion:** Consider not removing cards from the photos array after swipe since they're hidden off-screen anyway. This would prevent array index changes from triggering React re-renders that may cause the flash.
**Resolution:** 18.1-FIX-2 implemented hidden tracking (no array mutation) and cascade transition flag. Black flash reduced but not eliminated. New issue UAT-003 tracks remaining problem.
**Fixed in:** 18.1-FIX-2-PLAN.md
**Commit:** a5c4e64

### UAT-001: Black flash after cascade animation (carried from UAT-015) - RESOLVED

**Discovered:** 2026-01-22 (originally identified in Phase 17)
**Phase/Plan:** 18.1 (deferred from Phase 17)
**Severity:** Major
**Feature:** Card triage animation / cascade effect
**Description:** Top card briefly flashes black after cascade animation completes. The animation fix noted in Phase 17 (UAT-015) was deferred to Phase 18.1 but was not implemented.
**Expected:** Smooth card cascade with no visual glitch
**Actual:** Black flash visible at end of cascade animation
**Repro:**
1. Open darkroom with multiple photos
2. Swipe a card to triage
3. Watch the cascade animation complete
4. Observe brief black flash on top card

**Resolution:** Added timing-based blur overlay fade-out (200ms with ease-out easing) when card transitions from stack position to front position. This gives the Image component time to fully render before the overlay fades, preventing the brief black flash.
**Fixed in:** 18.1-FIX-PLAN.md
**Commit:** 0c2e05d

---

*Phase: 18.1-batched-darkroom-triage-with-undo*
*Tested: 2026-01-23*
