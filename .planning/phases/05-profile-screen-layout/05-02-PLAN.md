---
phase: 05-profile-screen-layout
plan: 02
type: execute
---

<objective>
Add profile thumbnail to nav bar and enable viewing other users' profiles.

Purpose: Complete the profile screen integration by updating the tab bar icon and supporting other user profile views.
Output: Nav bar shows user's profile photo, ProfileScreen adapts layout when viewing other users (back arrow, no settings, no edit button).
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-profile-screen-layout/05-CONTEXT.md
@.planning/phases/05-profile-screen-layout/05-01-SUMMARY.md

# Key files

@src/navigation/AppNavigator.js
@src/screens/ProfileScreen.js
@src/context/AuthContext.js

**Tech stack available:** React Native, Expo, Image, useRoute hook
**Established patterns:** Tab bar icons, route params, conditional rendering
**Constraining decisions:**

- Profile thumbnail in nav bar (Instagram-style circular photo)
- Other user view: back arrow (left), their username (center), no settings icon
- Other user view: no edit button visible
- Social action buttons deferred to future phase (view-only for now)

**Note:** PROJECT.md originally scoped "own profile only" but CONTEXT.md (from discuss-phase) explicitly includes other user profile adaptation for layout scaffolding. This is intentional — building the layout to handle both cases now avoids retrofitting later.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Profile thumbnail in tab bar</name>
  <files>src/navigation/AppNavigator.js</files>
  <action>
Replace the ProfileIcon SVG component in the tab bar with the user's profile photo:

1. In MainTabNavigator, get userProfile from AuthContext (useAuth is already imported)

2. Create a new ProfileTabIcon component that receives { color, focused } props:
   - If userProfile?.photoURL exists:
     - Render Image with source={{ uri: userProfile.photoURL }}
     - Style: width 28, height 28, borderRadius 14 (circular)
     - Border: 2px solid (use color prop for border color - active/inactive states)
   - If no photoURL:
     - Render the existing ProfileIcon SVG (fallback)

3. Update the Profile tab's tabBarIcon option:
   - Change from `({ color }) => <ProfileIcon color={color} />`
   - To `({ color, focused }) => <ProfileTabIcon color={color} focused={focused} />`

4. Add focused state styling:
   - When focused: borderWidth 2, borderColor color (shows selection)
   - When not focused: borderWidth 1, borderColor transparent or subtle

Keep the ProfileIcon component as fallback. Do not remove it.
</action>
<verify>Tab bar shows user's profile photo (or fallback icon if no photo) instead of generic profile icon</verify>
<done>Profile tab shows circular user photo thumbnail, with proper active/inactive styling</done>
</task>

<task type="auto">
  <name>Task 2: Other user profile view adaptation</name>
  <files>src/screens/ProfileScreen.js</files>
  <action>
Adapt ProfileScreen to handle viewing other users' profiles via route params:

1. Get route params using useRoute hook:

   ```javascript
   const route = useRoute();
   const { userId, username: routeUsername } = route.params || {};
   ```

2. Determine if viewing self vs other user:

   ```javascript
   const { user, userProfile } = useAuth();
   const isOwnProfile = !userId || userId === user?.uid;
   ```

3. For other user profiles (isOwnProfile === false):
   - Header changes:
     - Left: Back arrow (chevron-back) instead of Friends icon → navigation.goBack()
     - Center: routeUsername or "Profile" (passed via route params)
     - Right: No settings icon (render empty View for spacing or omit)
   - Content changes:
     - Hide edit icon next to username (conditional render based on isOwnProfile)

4. For own profile (isOwnProfile === true):
   - Keep current header: Friends (left), username (center), Settings (right)
   - Show edit icon next to username

5. Profile data handling for other users:
   - For now, show placeholder content for other users (since we don't have a service to fetch other user's profile)
   - Display: routeUsername in header, placeholder "User Profile" content
   - TODO comment: "// TODO: Fetch other user's profile data from Firestore"

Note: Full other-user data fetching is deferred. This task sets up the conditional layout structure.
</action>
<verify>Own profile shows Friends/Settings header, other user profile (via params) shows back arrow and hides edit icon</verify>
<done>ProfileScreen conditionally renders header/edit button based on isOwnProfile flag</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Profile thumbnail in nav bar and other user profile view adaptation</what-built>
  <how-to-verify>
    1. Run: npx expo start (if not running)
    2. Look at bottom tab bar → Profile tab should show your profile photo (circular thumbnail)
       - If you have no profile photo, should show fallback icon
       - Active state should show border highlight
    3. Navigate to Profile tab → verify own profile header shows Friends/Settings icons
    4. To test other user view, temporarily add a test navigation:
       - From FriendsList or another screen, navigate with:
         `navigation.navigate('Profile', { screen: 'ProfileMain', params: { userId: 'test123', username: 'testuser' } })`
       - Or add a temporary button in ProfileScreen to simulate viewing another user
    5. Verify other user view:
       - Header shows back arrow (left), username (center), no settings icon (right)
       - No edit icon next to username
       - Tapping back arrow returns to previous screen
  </how-to-verify>
  <resume-signal>Type "approved" if both features work correctly, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] App runs without errors
- [ ] Tab bar shows profile photo thumbnail (or fallback)
- [ ] Own profile: Friends/Settings header, edit icon visible
- [ ] Other user profile: Back arrow header, no edit icon
- [ ] Navigation works correctly in all scenarios
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Profile tab shows user's photo thumbnail
- ProfileScreen correctly adapts between own/other user views
- Phase 5 complete
  </success_criteria>

<output>
After completion, create `.planning/phases/05-profile-screen-layout/05-02-SUMMARY.md`

Include note that Phase 5 is complete and ready for Phase 6: Selects Banner.
</output>
