---
phase: 03-swipe-gesture-triage
plan: 01
type: execute
---

<objective>
Create SwipeablePhotoCard component with iOS Mail-style swipe actions for photo triage.

Purpose: Replace button-based triage with native iOS swipe gestures (left = Archive, right = Journal) for more intuitive, familiar interaction pattern.
Output: Reusable SwipeablePhotoCard component with animated swipe actions and visual feedback.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-navigation-restructure/01-01-SUMMARY.md
@.planning/phases/02-darkroom-bottom-sheet/02-01-SUMMARY.md
@.planning/phases/02-darkroom-bottom-sheet/02-02-SUMMARY.md
@src/screens/DarkroomScreen.js
@src/components/PhotoDetailModal.js

**Tech stack available:**
- react-native-gesture-handler ~2.28.0 (Swipeable component)
- react-native-reanimated ~3.16.1 (smooth animations)
- expo-haptics ~15.0.8 (tactile feedback)

**Established patterns:**
- PanResponder usage in PhotoDetailModal for swipe-down gesture
- Haptic feedback in DarkroomBottomSheet at progress milestones
- Logger usage for user interactions (DEBUG/INFO levels)
- Component exports via src/components/index.js

**Constraining decisions:**
- Phase 1: Navigation structure changed - Darkroom accessed from Camera button
- Phase 2: Press-and-hold reveal interaction established with haptic feedback
- Must not interfere with bottom sheet gestures (press-and-hold is on CameraScreen, swipe will be on DarkroomScreen)

**Current triage implementation:**
- DarkroomScreen.js lines 165-185: Two TouchableOpacity buttons (Archive/Journal)
- handleTriage function (lines 72-90) handles photoService.triagePhoto calls
- Alert.alert shows confirmation after triage completion
- Photo removed from list after successful triage
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SwipeablePhotoCard component with gesture detection</name>
  <files>src/components/SwipeablePhotoCard.js, src/components/index.js</files>
  <action>
Create new SwipeablePhotoCard component using react-native-gesture-handler's Swipeable:

**Component Structure:**
- Import Swipeable from 'react-native-gesture-handler'
- Accept props: photo (object), onSwipeLeft (callback for Archive), onSwipeRight (callback for Journal)
- Render photo Image with rounded corners (match DarkroomScreen photoCard styling)
- Wrap in Swipeable with renderLeftActions and renderRightActions

**Swipe Actions:**
- Left swipe reveals Archive action (gray background, ðŸ“¦ icon, "Archive" text)
- Right swipe reveals Journal action (green background, ðŸ“– icon, "Journal" text)
- Action width: 120px (enough to show icon + text clearly)
- Action background colors: Archive #8E8E93 (iOS gray), Journal #34C759 (iOS green) - match iOS system colors

**Swipe Behavior:**
- overshootLeft={false}, overshootRight={false} - prevent over-stretching
- onSwipeableOpen={(direction) => { callback based on direction }} - trigger triage action
- Use Animated.View in renderLeftActions/renderRightActions for smooth reveal

**Visual Feedback:**
- Photo has subtle scale animation on swipe start (scale to 0.98) using Animated API
- Action labels fade in as user swipes (opacity 0 â†’ 1 based on swipe progress)
- Action icons scale in (scale 0.8 â†’ 1) for spring effect

**Error Handling:**
- Wrap in try/catch for gesture handler errors
- Log errors with logger.error if Swipeable fails to initialize

**Logging:**
- logger.debug on component mount/unmount
- logger.info when swipe action triggered with direction

**Why not PanResponder:** Swipeable component provides iOS Mail-style swipe behavior out of the box with built-in animations and gesture handling. PanResponder would require 100+ lines of custom gesture math and animation logic.

Add export to src/components/index.js.
  </action>
  <verify>
Component renders without errors in DarkroomScreen (next task will integrate).
Swipeable actions visible when swiping left/right on photo card.
No console errors related to gesture-handler or reanimated.
  </verify>
  <done>
SwipeablePhotoCard.js created with Swipeable wrapper, renderLeftActions (Archive), renderRightActions (Journal), onSwipeableOpen callback, smooth animations, and comprehensive logging.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add visual polish and swipe progress feedback</name>
  <files>src/components/SwipeablePhotoCard.js</files>
  <action>
Enhance SwipeablePhotoCard with progressive visual feedback during swipe:

**Progress-based Animations:**
- Use Animated.View with interpolation based on swipe distance
- Action background opacity: 0 at 0px â†’ 1 at 60px swipe
- Action text opacity: 0 at 0px â†’ 1 at 80px swipe
- Action icon scale: 0.5 at 0px â†’ 1.0 at 100px swipe
- Photo scale: 1.0 at 0px â†’ 0.98 at 60px swipe (subtle zoom-out)

**Swipe Completion Threshold:**
- Set Swipeable's leftThreshold and rightThreshold to 100px (iOS Mail behavior - must swipe ~1/3 screen width)
- If swipe doesn't reach threshold, spring back to center
- If threshold reached, complete swipe and trigger callback

**Action Label Layout:**
- Archive action (left): Gray background (#8E8E93), white text, centered icon + label
- Journal action (right): Green background (#34C759), white text, centered icon + label
- Use flexDirection: 'row', alignItems: 'center', justifyContent: 'center'
- Icon fontSize: 32, label fontSize: 16 (semibold weight)

**Photo Card Styling:**
- Match existing DarkroomScreen photoCard styles (borderRadius: 24, backgroundColor: '#2C2C2E')
- Width: 90% of screen width (centered with marginHorizontal: '5%')
- Height: 65% of available space (match current photoImage aspect ratio)
- Shadow for depth: shadowColor: '#000', shadowOpacity: 0.3, shadowRadius: 8, elevation: 5

**Delete Button Handling:**
- SwipeablePhotoCard does NOT handle delete - only Archive/Journal
- Delete button remains as separate TouchableOpacity in DarkroomScreen (destructive action needs confirmation Alert)

**Logging:**
- logger.debug for swipe progress milestones (25%, 50%, 75%, 100%)
- logger.info when swipe completes with action (Archive/Journal)

**Why progressive feedback matters:** iOS Mail provides continuous visual feedback during swipe (action becomes more visible/prominent as you swipe further). This creates natural affordance and confirms the gesture is working.
  </action>
  <verify>
Swipe left shows progressively visible Archive action (gray background, ðŸ“¦ icon).
Swipe right shows progressively visible Journal action (green background, ðŸ“– icon).
Photo scales down slightly during swipe (0.98 scale).
Swipe springs back if threshold not met, completes if threshold exceeded.
No layout issues or overlapping elements.
  </verify>
  <done>
SwipeablePhotoCard has progressive swipe feedback with interpolated animations, threshold-based completion (100px), visually polished action labels with iOS colors, photo scale animation, and comprehensive logging.
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] SwipeablePhotoCard component renders photo correctly
- [ ] Swipe left reveals Archive action with progressive feedback
- [ ] Swipe right reveals Journal action with progressive feedback
- [ ] Swipe threshold behavior works (spring back vs complete)
- [ ] Photo scales during swipe (0.98)
- [ ] Action labels fade in based on swipe progress
- [ ] Component exported in src/components/index.js
- [ ] No console errors or warnings
- [ ] Logging present for mount, swipe events, completion
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- SwipeablePhotoCard component ready for DarkroomScreen integration
- Visual feedback matches iOS Mail swipe-to-action pattern
- No errors in Expo Go console
  </success_criteria>

<output>
After completion, create `.planning/phases/03-swipe-gesture-triage/03-01-SUMMARY.md`:

# Phase 3 Plan 1: Swipeable Photo Card Component Summary

**[One-line description of what shipped]**

## Accomplishments

- Created SwipeablePhotoCard component with react-native-gesture-handler
- Implemented left/right swipe actions (Archive/Journal) with iOS Mail-style behavior
- Added progressive visual feedback during swipe (opacity, scale animations)
- [Additional accomplishments]

## Files Created/Modified

- `src/components/SwipeablePhotoCard.js` - [Description of implementation]
- `src/components/index.js` - Added SwipeablePhotoCard export

## Decisions Made

[Key technical decisions and rationale]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for **03-02-PLAN.md** - Integrate SwipeablePhotoCard into DarkroomScreen, replace button-based triage, add haptic feedback on swipe completion.
</output>
