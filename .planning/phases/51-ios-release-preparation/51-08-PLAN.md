---
phase: 51-ios-release-preparation
plan: 08
type: execute
---

<objective>
Implement name color display across the entire app — contributors' names show in their chosen color everywhere instead of default white.

Purpose: The visible perk that makes contributions worthwhile. Contributors get a subtle, everywhere-visible mark of support.
Output: All name display components respect the nameColor field, falling back to default white.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/51-ios-release-preparation/51-CONTEXT.md

@src/context/AuthContext.js
@src/constants/colors.js

**Components that display usernames/display names (from grep):**

- `src/components/FriendStoryCard.js` — story bar user name
- `src/components/MeStoryCard.js` — own story name
- `src/components/SwipeablePhotoCard.js` — photo card username
- `src/components/StoriesViewerModal.js` — story viewer username
- `src/components/FeedPhotoCard.js` — feed card username
- `src/components/FriendCard.js` — friends list name
- `src/components/TaggedPeopleModal.js` — tagged people list
- `src/components/TagFriendsModal.js` — tag friends list
- `src/components/AlbumBar.js` — album bar name
- `src/components/comments/CommentRow.js` — comment author name
- `src/components/comments/CommentWithReplies.js` — reply author name
- `src/components/comments/CommentPreview.js` — comment preview name
- `src/components/comments/MentionText.js` — @mention text
- `src/components/comments/MentionSuggestionsOverlay.js` — autocomplete suggestion names
- `src/components/PhotoDetailModal.js` — photo detail username
- `src/screens/ProfileScreen.js` — own profile name
- `src/screens/OtherUserProfile.js` (if exists) — other user profile name

**Approach:**

- User documents already have `nameColor` field (set in 51-07)
- Most components receive user data as props (user object with displayName, username, etc.)
- Need to read `nameColor` from user data and apply as text color
- Default: existing white/text color when nameColor is null/undefined

**Key principle:** Minimal, surgical changes. Each component just adds `{ color: user?.nameColor || colors.text.primary }` to the name Text style. No architecture changes needed.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update all feed and story components to show name colors</name>
  <files>src/components/FeedPhotoCard.js, src/components/SwipeablePhotoCard.js, src/components/FriendStoryCard.js, src/components/MeStoryCard.js, src/components/StoriesViewerModal.js, src/components/PhotoDetailModal.js</files>
  <action>
For each component, find where the username or display name is rendered as a Text element and add the nameColor override:

**Pattern:** Wherever you see something like:

```jsx
<Text style={styles.username}>{user.displayName}</Text>
```

Add the color override:

```jsx
<Text style={[styles.username, user?.nameColor && { color: user.nameColor }]}>
  {user.displayName}
</Text>
```

**FeedPhotoCard.js:** Find the username Text in the card header. The user data is likely passed as a prop or comes from photo.user/photo.userId lookup.

**SwipeablePhotoCard.js:** Same pattern — find username display in the swipeable card.

**FriendStoryCard.js:** Username below the story ring avatar.

**MeStoryCard.js:** Own name below story ring. Use own profile's nameColor from AuthContext.

**StoriesViewerModal.js:** Username overlay in the story viewer.

**PhotoDetailModal.js:** Username in the photo detail view.

For each file:

1. Read the file to find the exact Text element and style name
2. Identify where user data comes from (props, context, etc.)
3. Add `user?.nameColor && { color: user.nameColor }` as a style array item
4. Ensure fallback to existing color when nameColor is null

Do NOT change any styles.js files — the color override is inline via style array. This keeps the change minimal and easily reversible.
</action>
<verify>Run `grep -n "nameColor" src/components/FeedPhotoCard.js src/components/SwipeablePhotoCard.js src/components/FriendStoryCard.js src/components/MeStoryCard.js src/components/StoriesViewerModal.js src/components/PhotoDetailModal.js` shows nameColor used in each file</verify>
<done>All 6 feed/story components display contributor name colors.</done>
</task>

<task type="auto">
  <name>Task 2: Update social, comment, and profile components to show name colors</name>
  <files>src/components/FriendCard.js, src/components/TaggedPeopleModal.js, src/components/TagFriendsModal.js, src/components/AlbumBar.js, src/components/comments/CommentRow.js, src/components/comments/CommentWithReplies.js, src/components/comments/CommentPreview.js, src/components/comments/MentionText.js, src/components/comments/MentionSuggestionsOverlay.js, src/screens/ProfileScreen.js</files>
  <action>
Same pattern as Task 1 — add nameColor support to all remaining components that display usernames:

**FriendCard.js:** Display name in friends list.

**TaggedPeopleModal.js:** Names in tagged people list.

**TagFriendsModal.js:** Names in tag selection list.

**AlbumBar.js:** Name in album bar (if visible).

**CommentRow.js:** Comment author name. This is a key visibility point — comment sections are heavily used.

**CommentWithReplies.js:** Reply author name (may delegate to CommentRow, check first).

**CommentPreview.js:** Comment preview name.

**MentionText.js:** @mentioned names in comment text. These are rendered as styled spans within the comment. Apply nameColor to the mention Text style. This is important — when someone @mentions a contributor, their name should show in their color.

**MentionSuggestionsOverlay.js:** Names in the autocomplete dropdown.

**ProfileScreen.js:** Own display name on the profile screen. Read nameColor from AuthContext's userProfile.

For MentionText specifically: the mention data includes the userId. You'll need to look up the mentioned user's nameColor. If the mention data doesn't include nameColor, check if it's available from the user lookup that already happens for mentions (the mentionedUsers array or similar). If not readily available, skip MentionText for now — it's a lower priority than direct name displays.

**Each file:** Same approach — find name Text, add `user?.nameColor && { color: user.nameColor }` to style array.
</action>
<verify>Run `grep -rn "nameColor" src/components/ src/screens/ProfileScreen.js` shows nameColor used in all updated files</verify>
<done>All social, comment, and profile components display contributor name colors.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Name color display across the entire app — contributors' usernames appear in their chosen color in feed, stories, comments, profiles, friends list, tags, and mentions</what-built>
  <how-to-verify>
    1. Run: `npx expo start`
    2. Set a test nameColor on your user document in Firestore (e.g., add field `nameColor: "#00FFFF"` to your user document)
    3. Open the app and check these locations:
       - Feed: Your name on your photos should be cyan
       - Story bar: Your story name should be cyan
       - Comments: Your comment author name should be cyan
       - Profile: Your display name should be cyan
       - Friends list: Your name should be cyan (ask a friend to check, or use a second account)
    4. Remove nameColor from Firestore → names should revert to default white
    5. Verify no visual glitches or layout shifts from the color override
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All name display components have nameColor support
- [ ] Default color (white) used when nameColor is null/undefined
- [ ] No layout shifts or visual glitches from color override
- [ ] `npm run lint` passes
- [ ] Human verification approved
</verification>

<success_criteria>

- Contributors' names display in their chosen color everywhere in the app
- Non-contributors see default white names (no change)
- Color override is minimal and inline (no architecture changes)
- All major name display points covered
  </success_criteria>

<output>
After completion, create `.planning/phases/51-ios-release-preparation/51-08-SUMMARY.md`
</output>
