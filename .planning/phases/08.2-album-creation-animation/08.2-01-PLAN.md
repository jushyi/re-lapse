---
phase: 08.2-album-creation-animation
plan: 01
type: execute
---

<objective>
Add visual feedback animation when a new album is created - scroll to albums bar, scroll to new album, and highlight with scale bounce.

Purpose: Provide clear confirmation that album creation succeeded without being disruptive.
Output: Smooth, polished animation sequence (Instagram highlights style) that draws attention to newly created album.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08.2-album-creation-animation/08.2-CONTEXT.md

# Key files:

@src/components/AlbumCard.js
@src/components/AlbumBar.js
@src/screens/ProfileScreen.js
@src/screens/AlbumPhotoPickerScreen.js

**Tech stack available:** react-native-reanimated (already in project), React Navigation params
**Established patterns:** Horizontal FlatList for card galleries, useFocusEffect for screen refresh
**Constraining decisions:**

- Phase 8-02: AlbumBar uses horizontal FlatList with albums data
- Phase 8-03: Album creation navigates to 'ProfileMain' on success
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Add animation support to AlbumCard and AlbumBar</name>
  <files>src/components/AlbumCard.js, src/components/AlbumBar.js</files>
  <action>
**AlbumCard.js:**
1. Import Animated and useSharedValue, useAnimatedStyle, withSpring, withDelay from react-native-reanimated
2. Add `isHighlighted` prop (boolean, default false)
3. When isHighlighted transitions to true, run scale bounce animation:
   - Scale from 1.0 → 1.08 → 1.0 using withSpring (damping ~8, stiffness ~300)
   - Use withDelay to start after a brief 100ms pause (allows scroll to complete visually)
4. Wrap the TouchableOpacity in an Animated.View with animatedStyle
5. Use useEffect to trigger animation when isHighlighted changes to true

**AlbumBar.js:**

1. Import forwardRef and useImperativeHandle from react
2. Import useRef for FlatList ref
3. Convert component to forwardRef pattern
4. Add `highlightedAlbumId` prop (string, default null) - passes to AlbumCard
5. Add ref to FlatList and expose scrollToAlbum(albumId) method via useImperativeHandle:
   - Find index of album by ID
   - Call flatListRef.current.scrollToIndex({ index, animated: true, viewPosition: 0.5 })
6. In renderItem, pass isHighlighted={item.id === highlightedAlbumId} to AlbumCard

Use spring animation for iOS native feel. Do NOT use withTiming - spring feels more natural.
</action>
<verify>Import AlbumBar and AlbumCard in isolation test - pass isHighlighted=true to AlbumCard, confirm scale animation plays</verify>
<done>AlbumCard animates with scale bounce when isHighlighted=true, AlbumBar exposes scrollToAlbum(albumId) method via ref</done>
</task>

<task type="auto">
  <name>Task 2: Wire animation sequence in ProfileScreen</name>
  <files>src/screens/ProfileScreen.js, src/screens/AlbumPhotoPickerScreen.js</files>
  <action>
**AlbumPhotoPickerScreen.js:**
1. After successful createAlbum (line ~121), pass newAlbumId in navigation:
   ```javascript
   navigation.navigate('ProfileMain', { newAlbumId: result.album.id });
   ```

**ProfileScreen.js:**

1. Import useRef for ScrollView and AlbumBar refs
2. Add refs: `scrollViewRef = useRef(null)` and `albumBarRef = useRef(null)`
3. Add state: `highlightedAlbumId` (string, default null)
4. Attach scrollViewRef to ScrollView, albumBarRef to AlbumBar
5. Pass highlightedAlbumId to AlbumBar component
6. In useFocusEffect (or new useEffect watching route.params), detect newAlbumId:
   ```javascript
   const { newAlbumId } = route.params || {};
   if (newAlbumId) {
     // Clear param to prevent re-trigger on future focus
     navigation.setParams({ newAlbumId: undefined });
     // Run animation sequence after albums are fetched
     runNewAlbumAnimation(newAlbumId);
   }
   ```
7. Create runNewAlbumAnimation(albumId) function:
   a. Wait for albums state to include the new album (may need small delay or useEffect)
   b. Scroll ScrollView down to albums section (approximately 450-500px from top, or use measure)
   c. After 300ms delay, call albumBarRef.current?.scrollToAlbum(albumId)
   d. After another 200ms, set highlightedAlbumId to albumId
   e. After 1 second, clear highlightedAlbumId (set to null)

**Timing sequence (total ~1.8s):**

- 0ms: Scroll ScrollView to albums
- 300ms: Scroll FlatList to new album
- 500ms: Set highlightedAlbumId (triggers scale bounce)
- 1500ms: Clear highlightedAlbumId

Use setTimeout for sequencing. Avoid complex animation orchestration - simple delays work well for this use case.
</action>
<verify>Create a new album from ProfileScreen. After creation, observe: (1) ProfileScreen scrolls to show albums bar, (2) album bar scrolls to new album, (3) new album card does scale bounce animation</verify>
<done>New album creation shows scroll + highlight animation sequence. Animation plays once then clears. No re-trigger on screen revisit.</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Create new album → animation sequence plays (scroll + highlight)
- [ ] Animation only plays once per album creation (no re-trigger on focus)
- [ ] Albums bar scrolls to correct album position
- [ ] Scale bounce animation is smooth, spring-based, iOS-native feel
- [ ] No console errors or warnings
- [ ] Existing album functionality unchanged (tap to view, long press menu)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Animation feels polished and native (Instagram highlights quality)
- No disruption to existing album functionality
- Clear visual confirmation of album creation
  </success_criteria>

<output>
After completion, create `.planning/phases/08.2-album-creation-animation/08.2-01-SUMMARY.md`
</output>
