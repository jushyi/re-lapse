---
phase: 18.4-triage-animation-arc-adjustment
plan: 01
type: execute
---

<objective>
Adjust Journal/Archive triage animation path from linear arc to exponential curve for more natural physics-based motion.

Purpose: The current linear arc (y = 0.4 * |x|) dives down immediately. An exponential curve starts flat/horizontal and steepens as the card exits, creating momentum-like feel.
Output: Cards follow exponential path and rotation curve - starts flat/upright, gradually steepens/rotates as they accelerate off screen.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18.4-triage-animation-arc-adjustment/18.4-CONTEXT.md

# Key files:
@src/components/SwipeablePhotoCard.js

# Prior context from Phase 17-02:
- Current arc formula: `arcY = Math.abs(translateX.value) * 0.4` (LINEAR)
- Rotation formula: `rotation = translateX.value / 15`
- Using Gesture.Pan() API with GestureDetector
- BUTTON_EXIT_DURATION = 1200ms for button-triggered animations
- EXIT_DURATION = 400ms for swipe gestures
- Exit animations use: translateX → ±SCREEN_WIDTH * 1.5, translateY → SCREEN_HEIGHT * 0.5

# From 18.4-CONTEXT.md:
- Exponential curve: y-displacement increases as x-displacement increases (steeper over time)
- Rotation curve matches: starts near 0°, increases as card moves further from center
- Delete animation unchanged (suction effect from Phase 18.3)
- Timing/duration unchanged - only motion path changes
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace linear arc with exponential curve formula</name>
  <files>src/components/SwipeablePhotoCard.js</files>
  <action>
In SwipeablePhotoCard.js, update the arc calculation in cardStyle useAnimatedStyle:

**Current (linear):**
```javascript
const arcY = Math.abs(translateX.value) * 0.4;
```

**New (exponential):**
```javascript
// Normalize x to 0-1 range based on screen width
const normalizedX = Math.abs(translateX.value) / (SCREEN_WIDTH * 1.5);
// Exponential curve: starts flat (y ≈ 0), steepens as x increases
// Formula: y = k * (e^(ax) - 1) where:
// - normalizedX goes from 0 to 1 during exit
// - Result scaled to reach similar final Y position as before
const arcY = (SCREEN_HEIGHT * 0.5) * (Math.exp(2.5 * normalizedX) - 1) / (Math.exp(2.5) - 1);
```

This formula:
- At x=0: arcY ≈ 0 (starts flat)
- At x=25% exit: arcY ≈ 8% of final Y (still mostly flat)
- At x=50% exit: arcY ≈ 25% of final Y (starting to curve down)
- At x=100% exit: arcY = 100% of final Y (reaches intended exit position)

The exponential base (2.5) controls how quickly the curve steepens. Higher = more dramatic late curve.

**Alternative simpler formula (power curve):**
```javascript
const normalizedX = Math.abs(translateX.value) / (SCREEN_WIDTH * 1.5);
const arcY = (SCREEN_HEIGHT * 0.5) * Math.pow(normalizedX, 2.5);
```

Use the power curve (simpler) if exponential feels too aggressive. The exponent 2.5 makes motion start flat and accelerate.

**What to avoid:**
- Don't change delete animation (leave it as simple translateY drop or suction from 18.3)
- Don't change EXIT_DURATION or BUTTON_EXIT_DURATION - only the path shape
- Don't change the final destination (still exits at SCREEN_WIDTH * 1.5, SCREEN_HEIGHT * 0.5)
  </action>
  <verify>
1. Swipe right (journal) - card should stay mostly horizontal at first, then curve down more dramatically near exit
2. Swipe left (archive) - same exponential path, mirrored
3. Compare with old behavior - card should NOT immediately dive down, should feel like momentum/acceleration
  </verify>
  <done>Arc path follows exponential curve - starts flat, steepens as card exits, feeling like natural momentum.</done>
</task>

<task type="auto">
  <name>Task 2: Apply matching exponential curve to rotation</name>
  <files>src/components/SwipeablePhotoCard.js</files>
  <action>
Update the rotation calculation in cardStyle to use the same exponential curve:

**Current (linear):**
```javascript
const rotation = isActive ? translateX.value / 15 : 0;
```

**New (exponential):**
```javascript
// Rotation follows same exponential curve as arc path
// Starts near-upright, rotates more as card accelerates off screen
const normalizedX = Math.abs(translateX.value) / (SCREEN_WIDTH * 1.5);
const maxRotation = 25; // degrees at full exit
const rotationAmount = maxRotation * Math.pow(normalizedX, 2.5);
// Apply direction (negative for left swipe, positive for right)
const rotation = isActive ? (translateX.value > 0 ? rotationAmount : -rotationAmount) : 0;
```

This ensures:
- Card starts upright (rotation near 0°)
- Rotation increases as card moves further from center
- Arc and rotation accelerate together = cohesive motion
- Max rotation 25° at full exit (similar to current ~25° at SCREEN_WIDTH * 1.5 / 15)

**Refinement:**
Since arc uses `normalizedX = abs(translateX) / (SCREEN_WIDTH * 1.5)`, extract to a shared calculation:
```javascript
// Shared normalization for both arc and rotation
const normalizedX = Math.abs(translateX.value) / (SCREEN_WIDTH * 1.5);
const curveProgress = Math.pow(normalizedX, 2.5); // 0 at center, 1 at full exit

// Arc: exponential path
const arcY = (SCREEN_HEIGHT * 0.5) * curveProgress;

// Rotation: matches arc curve
const maxRotation = 25;
const rotationAmount = maxRotation * curveProgress;
const rotation = isActive ? (translateX.value > 0 ? rotationAmount : -rotationAmount) : 0;
```

**What to avoid:**
- Don't apply rotation to stack cards (they stay at rotation: 0)
- Don't change rotation during entry animation (enterFrom handling)
  </action>
  <verify>
1. Swipe right - card starts upright, rotates more as it exits
2. Swipe left - same behavior, rotation in opposite direction
3. Rotation and arc accelerate together (cohesive, not mismatched)
4. At rest position, rotation is 0 (card is upright)
  </verify>
  <done>Rotation follows same exponential curve as arc - starts upright, increases as card accelerates off screen.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Exponential curve for Journal/Archive triage animations - both arc path and rotation</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Open app and navigate to Darkroom with multiple photos
    3. Test swipe gestures:
       - Swipe RIGHT (Journal): Card should start moving mostly horizontally, then curve down and rotate more dramatically as it exits
       - Swipe LEFT (Archive): Same behavior mirrored
       - Compare to memory of old linear arc - should feel more like "flicking" with momentum
    4. Test button-triggered animations:
       - Tap Journal button: Same exponential path (slower due to BUTTON_EXIT_DURATION)
       - Tap Archive button: Same exponential path mirrored
    5. Verify cohesive motion:
       - Arc and rotation should accelerate together
       - Card starts flat/upright, ends tilted and curved down
       - Motion should feel physics-based, not robotic
    6. Verify delete unchanged:
       - Tap Delete button: Should drop straight down (or suction if 18.3 complete), NOT follow exponential arc
  </how-to-verify>
  <resume-signal>Type "approved" if animations feel natural with exponential curve, or describe specific issues (too aggressive, not enough curve, etc.)</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Journal/Archive animations follow exponential curve (starts flat, steepens)
- [ ] Rotation follows same curve (starts upright, increases with distance)
- [ ] Arc and rotation are cohesive (accelerate together)
- [ ] Motion feels like natural momentum/physics
- [ ] Delete animation unchanged (no arc, just drop/suction)
- [ ] Spring-back to center still works correctly
- [ ] Entry animation (undo) still works correctly
- [ ] No console errors or TypeScript warnings
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Swipe animations feel like "flicking from wrist" with momentum
- No regressions to delete animation or undo functionality
- Visual polish improved - animation feels more natural than linear
</success_criteria>

<output>
After completion, create `.planning/phases/18.4-triage-animation-arc-adjustment/18.4-01-SUMMARY.md`:

# Phase 18.4 Plan 01: Triage Animation Arc Adjustment Summary

**[Substantive one-liner about exponential curve implementation]**

## Accomplishments

- [Arc formula change]
- [Rotation formula change]
- [Cohesive motion achieved]

## Files Created/Modified

- `src/components/SwipeablePhotoCard.js` - Updated arc and rotation to exponential curves

## Decisions Made

[Curve exponent choice, formula selection, or "None"]

## Issues Encountered

[Any tuning needed, or "None"]

## Next Step

Phase 18.4 complete, v1.5 milestone ready for completion
</output>
