---
phase: 19-linting-prettier
plan: 02
type: execute
---

<objective>
Format entire codebase and verify pre-commit hooks work.

Purpose: Apply consistent formatting to all 48 source files and ensure the pre-commit enforcement is working.
Output: Fully formatted codebase with working pre-commit hooks that enforce code quality.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-linting-prettier/19-01-SUMMARY.md
@eslint.config.js
@.prettierrc
@package.json

**Constraints from v1.6 milestone:**

- No breaking changes - all external behavior must stay identical
- No functional changes - everything works exactly as it does now
- No visual changes - UI/UX must remain the same

**From CONCERNS.md - known issues to address:**

- 6 console.log() in SwipeablePhotoCard.js (CASCADE DEBUG)
- 4 console.error() in timeUtils.js (should be logger.error())

**Tech stack from 19-01:**

- ESLint 9.x with flat config
- Prettier 3.x
- Husky 9.x + lint-staged

**Codebase stats:**

- 48 JavaScript files in src/
- ~525 KB of source code
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Run ESLint fix and Prettier on entire codebase</name>
  <files>src/**/*.js, *.js (root config files)</files>
  <action>
First, run ESLint --fix to auto-correct all fixable issues:

```bash
cd "c:/Users/maser/Lapse Clone"
npx eslint . --fix
```

This may report errors that cannot be auto-fixed. Note them for manual resolution.

Then run Prettier to format all files:

```bash
npx prettier --write "src/**/*.{js,jsx}" "*.{js,json}"
```

**Expected issues to manually fix:**

1. **Console statements:** The CONCERNS.md notes:
   - `src/components/SwipeablePhotoCard.js` has 6 console.log() with `[CASCADE DEBUG]` prefix - DELETE these lines entirely
   - `src/utils/timeUtils.js` has 4 console.error() calls - REPLACE with `logger.error()` (import logger if not already imported)

2. **Unused imports/variables:** ESLint will flag these. Remove them.

3. **Potential rule violations:** If eslint-config-expo flags issues that require code changes, fix them. Common ones:
   - react-hooks/exhaustive-deps warnings (add missing dependencies or disable with comment if intentional)
   - Unused variables (remove or prefix with \_)

**Approach for console statement fixes:**

- For CASCADE DEBUG logs: Simply delete the entire console.log line
- For console.error in error handlers: Replace with logger.error() call, ensure logger is imported

**Avoid:** Don't use eslint-disable comments to bypass warnings - fix the actual issues. Don't suppress react-hooks warnings without good reason.
</action>
<verify>

- `npx eslint .` reports 0 errors (warnings acceptable for now)
- `npx prettier --check "src/**/*.js"` reports all files formatted
- No console.log statements remain in src/ (except in logger.js itself)
  </verify>
  <done>All files formatted, ESLint errors resolved, console.log/error statements cleaned up</done>
  </task>

<task type="auto">
  <name>Task 2: Verify pre-commit hook enforcement</name>
  <files>.husky/pre-commit</files>
  <action>
Test that the pre-commit hook actually runs lint-staged:

1. Make a small intentional formatting violation:
   - Open any src file
   - Add extra whitespace or remove a semicolon
   - Stage the file: `git add <file>`

2. Attempt to commit:

   ```bash
   git commit -m "test: verify pre-commit hook"
   ```

3. Observe that:
   - lint-staged runs (you'll see output)
   - The file is auto-fixed before commit
   - The commit succeeds with the fixed version

4. Verify the fix was applied:
   - Check the committed file has correct formatting
   - Or abort the commit and check the staged changes

5. Clean up the test:
   - If commit succeeded: `git reset --soft HEAD~1` to undo
   - Restore file to original state

**Alternative verification without actual commit:**

```bash
# Dry run lint-staged to see what would happen
npx lint-staged --dry-run
```

**Avoid:** Don't leave test commits in history. Don't skip verifying that hooks actually run (common issue: hooks not executable).
</action>
<verify>

- `npx lint-staged --dry-run` shows files that would be processed
- A test commit triggers lint-staged (visible output during commit)
- Auto-fixed changes are included in the commit
  </verify>
  <done>Pre-commit hook verified working, lint-staged runs on staged files</done>
  </task>

<task type="auto">
  <name>Task 3: Commit formatted codebase</name>
  <files>All modified files from formatting</files>
  <action>
Stage and commit all formatting changes:

```bash
cd "c:/Users/maser/Lapse Clone"

# Stage all formatting changes
git add -A

# Commit with descriptive message
git commit -m "style(19-02): format entire codebase with ESLint and Prettier

- Apply consistent formatting to all ~48 source files
- Remove CASCADE DEBUG console.log statements from SwipeablePhotoCard
- Replace console.error with logger.error in timeUtils
- Fix any ESLint auto-fixable violations

Part of v1.6 Code Quality milestone"
```

**Commit should include:**

- All reformatted src/\*_/_.js files
- Any root config files that were reformatted (App.js, etc.)
- Modified timeUtils.js (logger.error replacement)
- Modified SwipeablePhotoCard.js (debug removal)

**Avoid:** Don't split into multiple commits - this is a single atomic formatting change. Tooling infrastructure was already committed in 19-01.
</action>
<verify>

- `git status` shows clean working tree after commit
- `git log -1` shows "style(19-02): format entire codebase..."
- `git log -1 --stat` shows reformatted files
  </verify>
  <done>All formatting changes committed, Phase 19 complete</done>
  </task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx eslint .` reports 0 errors
- [ ] `npx prettier --check "src/**/*.js"` reports all files formatted
- [ ] `grep -r "console.log" src/ --include="*.js"` finds only logger.js (if any)
- [ ] `npx lint-staged --dry-run` runs successfully
- [ ] All changes committed to git
- [ ] Pre-commit hook works on new commits
</verification>

<success_criteria>

- All 48 source files formatted consistently
- ESLint reports 0 errors
- Debug console statements removed/replaced
- Pre-commit hooks verified working
- All changes committed
- Phase 19 complete
  </success_criteria>

<output>
After completion, create `.planning/phases/19-linting-prettier/19-02-SUMMARY.md`

Include in summary:

- Number of files formatted
- Issues found and fixed (console statements, unused imports, etc.)
- Pre-commit hook verification result
- Any warnings that remain (and why they're acceptable)
  </output>
