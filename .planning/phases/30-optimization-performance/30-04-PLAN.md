---
phase: 30-optimization-performance
plan: 04
type: execute
---

<objective>
Migrate remaining photo-heavy screens (RecentlyDeletedScreen, SelectsScreen, SelectsBanner) from React Native Image to expo-image.

Purpose: Complete expo-image migration for all screens identified in research as using unoptimized images.
Output: All remaining screens using expo-image with proper caching and optimization props.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/30-optimization-performance/30-RESEARCH.md
@.planning/phases/30-optimization-performance/30-03-SUMMARY.md
@src/screens/RecentlyDeletedScreen.js
@src/screens/SelectsScreen.js
@src/components/SelectsBanner.js

**Key findings from research:**

- RecentlyDeletedScreen uses React Native `Image` - deleted photos grid
- SelectsScreen uses React Native `Image` - selects photo picking
- SelectsBanner uses React Native `Image` - selects slideshow

**Established pattern:**

```javascript
import { Image } from 'expo-image';

<Image
  source={{ uri: photo.imageURL }}
  style={styles.photoImage}
  contentFit="cover"
  cachePolicy="memory-disk"
  priority="normal"
  recyclingKey={photo.id}
  transition={150}
/>;
```

</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate RecentlyDeletedScreen and SelectsScreen</name>
  <files>src/screens/RecentlyDeletedScreen.js, src/screens/SelectsScreen.js</files>
  <action>
**RecentlyDeletedScreen:**
1. Read the file to understand current structure
2. Change import from `import { Image } from 'react-native'` to `import { Image } from 'expo-image'`
3. Update all Image components:
   - Add `contentFit="cover"`
   - Add `cachePolicy="memory-disk"`
   - Add `priority="normal"`
   - Add `recyclingKey={photo.id}`
   - Add `transition={150}`
4. Add FlatList optimization props if using FlatList:
   - `initialNumToRender={9}`
   - `maxToRenderPerBatch={6}`
   - `windowSize={5}`
   - Add `getItemLayout` if fixed cell size

**SelectsScreen:**

1. Read the file to understand current structure
2. Change import from `import { Image } from 'react-native'` to `import { Image } from 'expo-image'`
3. Update all Image components (preview area and thumbnails):
   - Preview: `priority="high"`, `cachePolicy="memory-disk"`, `contentFit="cover"`
   - Thumbnails: `priority="low"`, `cachePolicy="memory-disk"`, `recyclingKey`, `transition={100}`
4. Ensure any FlatLists have optimization props
   </action>
   <verify>Open Recently Deleted screen, scroll photos. Open SelectsScreen from profile, interact with photos.</verify>
   <done>Both screens use expo-image with appropriate props for their use cases</done>
   </task>

<task type="auto">
  <name>Task 2: Migrate SelectsBanner and scan for remaining files</name>
  <files>src/components/SelectsBanner.js</files>
  <action>
**SelectsBanner:**
1. Change import from `import { Image } from 'react-native'` to `import { Image } from 'expo-image'`
2. Update Image component(s) for slideshow display:
   - Add `contentFit="cover"`
   - Add `cachePolicy="memory-disk"`
   - Add `priority="high"` (visible on profile, should load fast)
   - No recyclingKey needed if not in a list

**Scan for remaining RN Image usage in photo-heavy files:**

1. Run grep to find remaining `from 'react-native'` imports that include Image:
   ```bash
   grep -r "Image.*from 'react-native'" src/ --include="*.js" | grep -v node_modules
   ```
2. Review each file found:
   - If it displays photos from URLs (not local assets): migrate to expo-image
   - If it only uses local images (require()), can keep RN Image
   - Priority files: any screens or components that display user photos

3. Document which files still use RN Image and why (if intentional)
   </action>
   <verify>SelectsBanner on profile shows photos correctly. Grep shows expected files remaining.</verify>
   <done>SelectsBanner uses expo-image, remaining RN Image usages documented</done>
   </task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] App builds without errors
- [ ] RecentlyDeletedScreen displays and scrolls correctly
- [ ] SelectsScreen displays photos and selection works
- [ ] SelectsBanner on profile displays slideshow correctly
- [ ] Hold-to-pause, tap-to-open still work on SelectsBanner
- [ ] No TypeScript/ESLint errors
</verification>

<success_criteria>

- RecentlyDeletedScreen uses expo-image
- SelectsScreen uses expo-image for all photo displays
- SelectsBanner uses expo-image
- Codebase scan completed, remaining RN Image usages understood
- All photo grids have FlatList optimization props
  </success_criteria>

<output>
After completion, create `.planning/phases/30-optimization-performance/30-04-SUMMARY.md`

Include in summary:

- List of files migrated
- List of files still using RN Image (with rationale)
- Any issues encountered
  </output>
