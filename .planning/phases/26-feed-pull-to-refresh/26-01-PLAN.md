---
phase: 26-feed-pull-to-refresh
plan: 01
type: execute
---

<objective>
Enhance feed loading experience with Instagram-style shimmer skeleton and smooth content fade-in transitions.

Purpose: Create a polished loading experience where the skeleton-to-content transition feels seamless and branded.
Output: Updated FeedLoadingSkeleton with shimmer animation, FeedScreen with fade-in transitions.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/26-feed-pull-to-refresh/26-CONTEXT.md

# Key files

@src/screens/FeedScreen.js
@src/components/FeedLoadingSkeleton.js
@src/constants/colors.js

**What exists:**

- RefreshControl with iOS spinner already implemented in FeedScreen (working correctly)
- FeedLoadingSkeleton component with pulse opacity animation (0.3 to 0.7)
- Stories row skeleton and feed card skeletons that match actual feed structure

**What's needed:**

1. Replace pulse animation with Instagram-style shimmer (gradient sweep left-to-right)
2. Add fade-in transition when content loads (skeleton → real content)

**Tech available:**

- react-native-reanimated (already used throughout app)
- Animated from react-native (already imported in both files)

**Established patterns:**

- colors.background.tertiary (#1a1a1a) for skeleton placeholder color
- Animated.Value + interpolate for animations
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Add Instagram-style shimmer animation to FeedLoadingSkeleton</name>
  <files>src/components/FeedLoadingSkeleton.js</files>
  <action>
Replace the current pulse opacity animation with a shimmer effect that sweeps left-to-right across skeleton elements.

Implementation approach:

1. Use Animated.Value for horizontal translation (not opacity)
2. Create a shimmer overlay that moves across each skeleton element
3. Use linear gradient effect via masked view or overlay technique

Since expo-linear-gradient requires additional setup and MaskedView can be complex, use the simpler "moving highlight" approach:

- Skeleton base color: colors.background.tertiary (#1a1a1a)
- Shimmer highlight: slightly lighter color (~#2a2a2a)
- Animated highlight bar that sweeps across skeleton elements

Pattern:

```javascript
// Animated value that loops 0 → SCREEN_WIDTH
const shimmerPosition = useRef(new Animated.Value(-SCREEN_WIDTH)).current;

useEffect(() => {
  Animated.loop(
    Animated.timing(shimmerPosition, {
      toValue: SCREEN_WIDTH,
      duration: 1200,
      useNativeDriver: true,
    })
  ).start();
}, []);
```

Apply shimmer as a moving highlight bar (absolute positioned, semi-transparent) that translates across each skeleton element. Use overflow: 'hidden' on containers.

Keep skeleton structure unchanged - only modify the animation style.
Do NOT install new packages - work with existing react-native Animated API.
</action>
<verify>
Run Metro bundler: `npx expo start`
Load app in simulator, observe FeedScreen while stories/feed loads
Shimmer effect should sweep left-to-right continuously on skeleton elements
</verify>
<done>

- Shimmer animation replaces pulse
- Shimmer sweeps left-to-right at ~1.2s interval
- Skeleton base color stays dark, highlight sweeps across
- No new dependencies added
  </done>
  </task>

<task type="auto">
  <name>Task 2: Add fade-in transition when content loads</name>
  <files>src/screens/FeedScreen.js</files>
  <action>
Add smooth fade-in animation when feed content appears after loading completes.

Implementation:

1. Add contentOpacity Animated.Value (starts at 0)
2. When loading changes from true to false, animate opacity 0 → 1
3. Apply opacity to the content wrapper (FlatList and stories row)

Pattern:

```javascript
const contentOpacity = useRef(new Animated.Value(0)).current;
const wasLoading = useRef(true);

useEffect(() => {
  // Detect loading → loaded transition
  if (wasLoading.current && !loading) {
    // Animate fade in
    Animated.timing(contentOpacity, {
      toValue: 1,
      duration: 300,
      useNativeDriver: true,
    }).start();
  }
  wasLoading.current = loading;
}, [loading]);
```

Wrap the FlatList in an Animated.View with the opacity style.
Keep skeleton at full opacity (no fade needed for skeleton).

The fade should be subtle (300ms) - just enough to smooth the transition without feeling slow.

Do NOT modify existing RefreshControl, scroll handling, or any other FeedScreen functionality.
Only add the fade-in animation for the loading → loaded transition.
</action>
<verify>
Run app in simulator
Trigger initial load (cold start or pull-to-refresh)
Content should fade in smoothly when loading completes
Skeleton should remain visible until content is ready, then content fades in
</verify>
<done>

- Content fades in over 300ms when loading completes
- Skeleton stays visible until fade begins
- Transition feels smooth and polished
- No impact on existing scroll, refresh, or navigation behavior
  </done>
  </task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx expo start` runs without errors
- [ ] Shimmer animation visible on skeleton during loading
- [ ] Content fades in smoothly when loading completes
- [ ] Pull-to-refresh still works correctly (iOS spinner)
- [ ] No visual glitches or layout shifts during transition
- [ ] Stories row and feed cards both animate correctly
</verification>

<success_criteria>

- Both tasks completed
- All verification checks pass
- Loading experience matches Instagram-style polish
- No TypeScript/ESLint errors
- No regressions to existing feed functionality
  </success_criteria>

<output>
After completion, create `.planning/phases/26-feed-pull-to-refresh/26-01-SUMMARY.md`:

# Phase 26 Plan 01: Feed Loading Skeleton Enhancement Summary

**[One-liner about what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase complete, ready for Phase 27
</output>
