---
phase: 09-monthly-albums
plan: 03
type: execute
---

<objective>
Create read-only monthly album grid view with day-based sections and integrate MonthlyAlbumsSection into ProfileScreen.

Purpose: Complete the monthly albums feature by providing drill-down grid view and connecting everything to the profile screen.
Output: Fully functional monthly albums feature accessible from profile screen.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-monthly-albums/09-CONTEXT.md
@.planning/phases/09-monthly-albums/09-01-SUMMARY.md (will exist)
@.planning/phases/09-monthly-albums/09-02-SUMMARY.md (will exist)

**Relevant source files:**
@src/screens/AlbumGridScreen.js - Grid pattern to adapt for read-only monthly view
@src/screens/ProfileScreen.js - Integration target (replace Monthly Albums placeholder)
@src/components/MonthlyAlbumsSection.js (created in 09-02)
@src/services/firebase/monthlyAlbumService.js (created in 09-01)
@src/components/AlbumPhotoViewer.js - Photo viewer to reuse
@src/navigation/AppNavigator.js - Navigation registration

**Key constraints from CONTEXT.md:**

- Grid view uses same grid layout as user albums
- Within grid, photos sectioned by day: "Monday, January 15" format
- Read-only: no editing, rename, delete, add photos, or set cover options
- Tap any photo to open full-screen viewer (also read-only)
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Create MonthlyAlbumGridScreen with day-based sections</name>
  <files>src/screens/MonthlyAlbumGridScreen.js, src/navigation/AppNavigator.js</files>
  <action>
Create MonthlyAlbumGridScreen - a read-only grid view for monthly album photos with day-based section headers.

Route params:

- `month` - Month string in YYYY-MM format (e.g., "2026-01")
- `userId` - User ID to fetch photos for

Adapt from AlbumGridScreen with these key differences:

1. **Read-only mode**: No header menu (ellipsis), no add button, no long-press options
2. **Day-based sections**: Group photos by day with section headers
3. **Different header title**: Display "January 2026" format instead of album name

Data fetching:

- Use `getMonthPhotos(userId, month)` from monthlyAlbumService on mount
- Group fetched photos by day (extract from capturedAt timestamp)

Day section header format: "Monday, January 15"

```javascript
const formatDayHeader = capturedAt => {
  // capturedAt is Firestore Timestamp, convert to Date
  const date = capturedAt.toDate ? capturedAt.toDate() : new Date(capturedAt.seconds * 1000);
  return date.toLocaleDateString('en-US', {
    weekday: 'long',
    month: 'long',
    day: 'numeric',
  });
};
```

Grid structure using SectionList instead of FlatList:

- Sections: `[{ title: "Monday, January 15", data: [photo1, photo2, ...] }, ...]`
- SectionList with numColumns={3} not supported, so use FlatList with manual section headers:
  - Transform data to flat array with section markers: `[{ type: 'header', title: "Monday, January 15" }, { type: 'photo', photo }, ...]`
  - Render header items as full-width text
  - Render photo items in 3-column grid (handle columnWrapperStyle)

Actually, simpler approach - use FlatList with sticky section headers pattern:

- Data structure: photos grouped by day
- Use `ListHeaderComponent` for month title
- Render day headers inline between photo rows

Simplest approach - single FlatList:

1. Process photos into flat array with day headers interspersed
2. Each item is either `{ type: 'dayHeader', date: '...', title: 'Monday, January 15' }` or `{ type: 'photo', photo: {...} }`
3. Day headers span full width (use columnWrapperStyle only for photo rows, or make headers take 3 columns visually)

Header:

- Back button (chevron-back)
- Title: Format month as "January 2026" using `toLocaleDateString('en-US', { month: 'long', year: 'numeric' })`
- No right button (read-only, no menu)

Photo tap: Open AlbumPhotoViewer in read-only mode:

- Pass `isOwnProfile={false}` or add new prop `readOnly={true}` to disable edit options
- Actually, check AlbumPhotoViewer - it should hide edit options when `isOwnProfile={false}`

Grid styling: Same as AlbumGridScreen (3 columns, 2px gap, 3:4 aspect ratio cells).

Register screen in AppNavigator.js in the main stack.
</action>
<verify>Navigate to screen with test month, photos display in grid with day headers, tap opens viewer, no edit options visible</verify>
<done>MonthlyAlbumGridScreen shows photos grouped by day with section headers, read-only photo viewer works</done>
</task>

<task type="auto">
  <name>Task 2: Integrate MonthlyAlbumsSection into ProfileScreen</name>
  <files>src/screens/ProfileScreen.js</files>
  <action>
Replace the "Monthly Albums" placeholder in ProfileScreen with the actual MonthlyAlbumsSection component.

Changes to ProfileScreen:

1. Import MonthlyAlbumsSection:

```javascript
import { ..., MonthlyAlbumsSection } from '../components';
```

2. Replace the placeholder View (currently around line 457-459):

```javascript
// REMOVE this:
<View style={[styles.featurePlaceholder, styles.featurePlaceholderLarge]}>
  <Text style={styles.placeholderText}>Monthly Albums</Text>
</View>

// REPLACE with:
<MonthlyAlbumsSection
  userId={isOwnProfile ? user?.uid : userId}
  onMonthPress={handleMonthPress}
/>
```

3. Add handler for month press to navigate to grid view:

```javascript
const handleMonthPress = month => {
  logger.info('ProfileScreen: Monthly album pressed', { month });
  navigation.navigate('MonthlyAlbumGrid', {
    month,
    userId: isOwnProfile ? user?.uid : userId,
  });
};
```

4. Remove unused styles:

- `featurePlaceholder` style (if only used for this placeholder)
- `featurePlaceholderLarge` style
- `placeholderText` style

Actually, check if these styles are used elsewhere first. If the styles are also used by other placeholders, keep them.

The MonthlyAlbumsSection component handles its own margins (marginTop: 24 from Plan 02), so no additional wrapper needed.
</action>
<verify>ProfileScreen shows monthly albums section below album bar, tapping a month navigates to grid view</verify>
<done>Monthly albums visible on profile, navigation to grid view works, feature fully integrated</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete monthly albums feature: data layer, collapsible year sections, grid view with day headers, and profile integration</what-built>
  <how-to-verify>
    1. Run: npx expo start (or npm start)
    2. Open the app and navigate to Profile tab
    3. Scroll down past Albums bar to see Monthly Albums section
    4. Verify: Current year section is expanded, showing month cards
    5. Verify: Month cards are full-width with photo cover and month name overlay
    6. Tap a year header to collapse/expand - verify smooth animation
    7. Tap a month card to open grid view
    8. Verify: Grid shows photos grouped by day with headers like "Monday, January 15"
    9. Verify: No edit options visible (no menu button, no long-press actions)
    10. Tap a photo to open full-screen viewer
    11. Verify: Viewer is read-only (no remove/set cover options)
    12. Navigate back through all screens
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] MonthlyAlbumGridScreen created with day-based section headers
- [ ] Screen registered in AppNavigator
- [ ] ProfileScreen integrated with MonthlyAlbumsSection
- [ ] Navigation from profile to grid view works
- [ ] Grid view is read-only (no edit options)
- [ ] Photo viewer accessible and read-only
- [ ] Expand/collapse animations smooth
- [ ] `npm run build` or expo build succeeds without errors
</verification>

<success_criteria>

- All Phase 9 plans completed
- Monthly albums feature fully functional
- Profile → Year sections → Month grid → Photo viewer flow works
- All views are read-only as specified
- Phase 9 complete
  </success_criteria>

<output>
After completion, create `.planning/phases/09-monthly-albums/09-03-SUMMARY.md` with frontmatter:

```yaml
---
phase: 09-monthly-albums
plan: 03
subsystem: ui, navigation
tags: [react-native, grid-view, profile, integration]

requires:
  - phase: 09-01
    provides: monthlyAlbumService
  - phase: 09-02
    provides: MonthlyAlbumsSection component

provides:
  - MonthlyAlbumGridScreen for drill-down view
  - Complete monthly albums feature on profile

affects: [profile-screen]

tech-stack:
  added: []
  patterns: [day-section-headers, read-only-grid]

key-files:
  created:
    - src/screens/MonthlyAlbumGridScreen.js
  modified:
    - src/screens/ProfileScreen.js
    - src/navigation/AppNavigator.js

key-decisions: []
patterns-established: []
issues-created: []

duration: TBD
completed: TBD
---
```

**Phase 9 complete.** Update STATE.md and ROADMAP.md to reflect completion.
</output>
