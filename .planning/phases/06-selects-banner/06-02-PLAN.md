---
phase: 06-selects-banner
plan: 02
type: execute
---

<objective>
Implement fullscreen viewing for other profiles and edit mode for own profile when tapping the SelectsBanner.

Purpose: Complete the Selects banner interaction - view others' highlights fullscreen, edit your own highlights in-place.
Output: Working tap-to-expand (fullscreen or edit) with save capability for own profile.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-selects-banner/06-CONTEXT.md
@.planning/phases/06-selects-banner/06-01-PLAN.md

# Key files for this plan:

@src/screens/ProfileScreen.js
@src/screens/SelectsScreen.js
@src/components/SelectsBanner.js
@src/context/AuthContext.js

**From 06-CONTEXT.md:**

- Own profile tap: Opens edit interface with thumbnail bar from SelectsScreen
- Other profile tap: Opens simple fullscreen view-only slideshow
- Fullscreen: auto-play continues, hold-to-pause works, tap anywhere to exit
- Edit mode: reuses SelectsScreen components (thumbnail bar, reorder, add/remove)
- "Save highlights" button in edit mode

**Components to reuse from SelectsScreen:**

- DraggableThumbnail (drag-to-reorder)
- DeleteBar (drop to delete)
- Photo picker functions (handlePickSinglePhoto, handlePickMultiplePhotos)
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Create FullscreenSelectsViewer modal</name>
  <files>src/components/FullscreenSelectsViewer.js</files>
  <action>
Create a fullscreen modal for viewing selects (used for other users' profiles):

1. **Props:** `visible`, `selects` (array of URIs), `initialIndex`, `onClose`

2. **Modal structure:**
   - Use Modal from react-native with animationType="fade"
   - Full screen black background (colors.background.primary or pure black)
   - Image fills screen with resizeMode="contain"

3. **Auto-play logic (reuse pattern from SelectsBanner):**
   - Same 1.5s interval cycling
   - Track currentIndex starting from initialIndex prop
   - Clear on unmount

4. **Hold-to-pause:**
   - Same GestureDetector pattern as SelectsBanner
   - LongPress to pause, release to resume

5. **Tap to close:**
   - Gesture.Tap() calls onClose
   - Compose with Simultaneous/Race for both gestures

6. **SafeAreaView wrapper:**
   - Use SafeAreaView edges=['top', 'bottom'] for proper spacing
   - Optional: small X button in top-right corner as visual affordance

Avoid: Swipe navigation, progress dots, sharing features. Keep it simple view-only.
</action>
<verify>Component renders as modal overlay, cycles through photos, closes on tap.</verify>
<done>FullscreenSelectsViewer modal works with auto-play, hold-to-pause, and tap-to-close.</done>
</task>

<task type="auto">
  <name>Task 2: Create SelectsEditOverlay component</name>
  <files>src/components/SelectsEditOverlay.js</files>
  <action>
Create an edit overlay for own profile that reuses SelectsScreen patterns:

1. **Props:** `visible`, `selects` (array of URIs), `onSave`, `onClose`

2. **State management:**
   - Local selectedPhotos state initialized from selects prop
   - selectedIndex for preview display
   - isDragging, draggingIndex, isOverDeleteZone, hoverIndex for drag handling

3. **Layout (based on SelectsScreen but as overlay):**
   - Full screen overlay with semi-transparent black background
   - Top area: Large preview image (like SelectsScreen previewContainer)
   - Bottom area: Horizontal thumbnail strip with drag-reorder
   - Very bottom: "Save highlights" button + Cancel (X) button

4. **Reuse from SelectsScreen:**
   - Copy DraggableThumbnail component definition (or extract to shared component)
   - Copy DeleteBar component definition
   - Copy photo picker logic (handlePickSinglePhoto for empty slots)
   - Copy handleReorder, handleRemovePhoto, handleDragStart/End/Move logic

5. **Save functionality:**
   - "Save highlights" button calls onSave with array of URIs
   - Parent (ProfileScreen) handles actual Firestore update

6. **Cancel:**
   - X button in top-left or "Cancel" text button
   - Calls onClose without saving

Avoid: Full navigation to SelectsScreen - this is an overlay that appears in-place. Don't duplicate all SelectsScreen UI (no header, no step indicator, no "Complete Profile Setup" text).
</action>
<verify>Component renders as overlay with preview, thumbnail bar, drag-reorder working, save/cancel buttons present.</verify>
<done>SelectsEditOverlay provides full editing capability with save/cancel actions.</done>
</task>

<task type="auto">
  <name>Task 3: Wire up tap handlers in ProfileScreen</name>
  <files>src/screens/ProfileScreen.js</files>
  <action>
Connect SelectsBanner taps to appropriate actions:

1. **Import components:**
   - FullscreenSelectsViewer
   - SelectsEditOverlay

2. **Add state:**
   - showFullscreen (boolean)
   - showEditOverlay (boolean)
   - fullscreenInitialIndex (number) - which photo to start on

3. **Update handleSelectsTap:**
   - If isOwnProfile: setShowEditOverlay(true)
   - If !isOwnProfile: setShowFullscreen(true)
   - Log action for debugging

4. **Add save handler:**
   - handleSaveSelects(newSelects) - async function
   - Call updateUserDocumentNative(user.uid, { selects: newSelects })
   - Update local userProfile via updateUserProfile
   - Close overlay on success
   - Show Alert on error

5. **Render modals:**
   - Add FullscreenSelectsViewer with visible={showFullscreen}, appropriate props
   - Add SelectsEditOverlay with visible={showEditOverlay}, appropriate props
   - Both outside ScrollView, at end of component

6. **Handle empty state taps:**
   - If own profile with no selects: tap should open edit overlay (to add highlights)
   - SelectsBanner already calls onTap for empty state, same handler works

Avoid: Complex state management. Keep it simple with boolean visibility flags.
</action>
<verify>npm start - tap banner on own profile opens edit overlay, tap on other profile opens fullscreen viewer</verify>
<done>ProfileScreen handles taps correctly, showing appropriate overlay/modal for own vs other profiles.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Selects banner interaction: fullscreen viewing and edit mode with save capability</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Log in with account that has selects
    3. Go to Profile tab
    4. Tap the SelectsBanner
    5. Verify: Edit overlay opens with preview + thumbnail bar at bottom
    6. Test: Tap empty thumbnail slot - photo picker opens
    7. Test: Long-press drag a thumbnail - reorder works
    8. Test: Drag thumbnail to delete bar - removes photo
    9. Tap "Save highlights" - overlay closes, changes persist
    10. Verify: Profile shows updated selects order
    11. (If other user profiles accessible) Tap other user's selects
    12. Verify: Fullscreen viewer opens, cycles photos, tap to exit
    13. Test account with NO selects: tap empty banner
    14. Verify: Edit overlay opens allowing user to add photos
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] FullscreenSelectsViewer modal created and working
- [ ] SelectsEditOverlay component created with full edit capability
- [ ] ProfileScreen wires taps correctly (own = edit, other = fullscreen)
- [ ] Save functionality updates Firestore and local state
- [ ] Empty state tap opens edit overlay for own profile
- [ ] No console errors or warnings
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Own profile: tap opens edit with save capability
- Other profile: tap opens fullscreen view-only
- Selects updates persist to Firestore
- Phase 6 complete
  </success_criteria>

<output>
After completion, create `.planning/phases/06-selects-banner/06-02-SUMMARY.md`
</output>
