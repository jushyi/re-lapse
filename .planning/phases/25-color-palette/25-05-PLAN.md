---
phase: 25-color-palette
plan: 05
type: execute
domain: documentation
---

<objective>
Create documentation for adding theme selection to the new user onboarding flow.

Purpose: Guide for integrating theme picker as an optional step during profile setup.
Output: 06-ONBOARDING.md in docs/phase-25/
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/25-color-palette/25-CONTEXT.md
@src/screens/ProfileSetupScreen.js
@src/context/ThemeContext.js
@src/components/ThemeCard.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Onboarding guide</name>
  <files>docs/phase-25/06-ONBOARDING.md</files>
  <action>
Create the onboarding integration tutorial:

````markdown
# Adding Theme Selection to Onboarding

The final step is integrating theme selection into the new user profile setup flow.

## What You'll Build

- ThemePickerStep component for onboarding
- Integration into the existing ProfileSetupScreen
- Skip functionality (keeps default dark theme)
- Updated step indicator

## Learning Objectives

By the end of this guide, you will:

1. Understand multi-step form patterns
2. Learn to integrate new steps into existing flows
3. Handle optional steps (skip vs select)
4. Complete a full feature from concept to integration

## Current Onboarding Flow

Before we start, understand the existing flow:

1. **Profile info** (name, username, bio)
2. **Selects/highlights** (photo selection)
3. **Profile song** (optional)

We'll add theme picker as step 2, making it:

1. Profile info
2. **Theme Picker (NEW)** - optional
3. Selects/highlights
4. Profile song

## Step 1: Create ThemePickerStep Component

Create `src/components/ThemePickerStep.js`:

This is similar to AppearanceSettingsScreen but:

- Designed for onboarding flow (inline, not modal)
- Has Skip option (it's optional)
- Simpler layout (no preview/apply, direct selection)

**Try it yourself!** Think about:

- What props does this component need?
- How do you handle "Continue" vs "Skip"?
- Should you filter out the custom theme for new users?

<details>
<summary>ðŸ’¡ Hints</summary>

- Props: `onComplete` callback that receives themeId or null
- Continue: call `onComplete(selectedThemeId)`
- Skip: reset to default, call `onComplete(null)`
- Filter out custom theme - too complex for new users

</details>

<details>
<summary>âœ… Full Solution</summary>

```javascript
import React, { useState } from 'react';
import { View, Text, FlatList, TouchableOpacity, StyleSheet } from 'react-native';
import { useTheme } from '../context/ThemeContext';
import ThemeCard from './ThemeCard';
import { colors } from '../constants/colors';

const ThemePickerStep = ({ onComplete, initialThemeId = 'dark' }) => {
  const { themes, setTheme } = useTheme();
  const [selectedThemeId, setSelectedThemeId] = useState(initialThemeId);

  const handleThemeSelect = themeId => {
    setSelectedThemeId(themeId);
    setTheme(themeId); // Apply immediately for preview during onboarding
  };

  const handleContinue = () => {
    onComplete(selectedThemeId);
  };

  const handleSkip = () => {
    // Reset to default if they previewed other themes
    setTheme('dark');
    onComplete(null); // Signal skip
  };

  // Filter out 'custom' from onboarding - too complex for new users
  const availableThemes = themes.filter(t => !t.isCustom);

  return (
    <View style={styles.container}>
      <View style={styles.header}>
        <Text style={styles.title}>Choose your style</Text>
        <Text style={styles.subtitle}>You can always change this later in Settings</Text>
      </View>

      <FlatList
        data={availableThemes}
        numColumns={2}
        keyExtractor={item => item.id}
        renderItem={({ item }) => (
          <ThemeCard
            theme={item}
            isSelected={item.id === selectedThemeId}
            onPress={() => handleThemeSelect(item.id)}
          />
        )}
        contentContainerStyle={styles.grid}
        columnWrapperStyle={styles.row}
      />

      <View style={styles.buttons}>
        <TouchableOpacity style={styles.continueButton} onPress={handleContinue}>
          <Text style={styles.continueText}>Continue</Text>
        </TouchableOpacity>

        <TouchableOpacity style={styles.skipButton} onPress={handleSkip}>
          <Text style={styles.skipText}>Skip for now</Text>
        </TouchableOpacity>
      </View>
    </View>
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: colors.background.primary,
    padding: 16,
  },
  header: {
    marginBottom: 24,
  },
  title: {
    color: colors.text.primary,
    fontSize: 28,
    fontWeight: 'bold',
    marginBottom: 8,
  },
  subtitle: {
    color: colors.text.secondary,
    fontSize: 16,
  },
  grid: {
    paddingBottom: 16,
  },
  row: {
    justifyContent: 'space-between',
  },
  buttons: {
    marginTop: 'auto',
    paddingBottom: 20,
  },
  continueButton: {
    backgroundColor: colors.interactive.primary,
    padding: 16,
    borderRadius: 12,
    alignItems: 'center',
    marginBottom: 12,
  },
  continueText: {
    color: colors.text.primary,
    fontSize: 16,
    fontWeight: '600',
  },
  skipButton: {
    padding: 14,
    alignItems: 'center',
  },
  skipText: {
    color: colors.text.secondary,
    fontSize: 14,
  },
});

export default ThemePickerStep;
```
````

</details>

### Why preview during onboarding?

We call `setTheme(themeId)` immediately when the user taps a theme card. This gives instant visual feedback - they can see how the app looks with each theme before deciding. If they skip, we reset to default.

## Step 2: Understand ProfileSetupScreen

Before modifying ProfileSetupScreen, read through it and understand:

1. How are steps managed? (useState with step counter? array of steps?)
2. How does navigation between steps work?
3. Where is the step indicator rendered?

**Exercise:** Open `src/screens/ProfileSetupScreen.js` and answer:

- What variable tracks the current step?
- How many total steps are there currently?
- What function advances to the next step?

<details>
<summary>ðŸ’¡ What to look for</summary>

Common patterns you might find:

**Step counter pattern:**

```javascript
const [step, setStep] = useState(1);
const TOTAL_STEPS = 3;

const nextStep = () => setStep(prev => prev + 1);
```

**Step array pattern:**

```javascript
const steps = ['profile-info', 'selects', 'song'];
const [currentStepIndex, setCurrentStepIndex] = useState(0);
```

**Render switch:**

```javascript
{
  step === 1 && <ProfileInfoStep />;
}
{
  step === 2 && <SelectsStep />;
}
{
  step === 3 && <SongStep />;
}
```

</details>

## Step 3: Integrate ThemePickerStep

Once you understand the existing pattern, add the theme step.

**If using step counter pattern:**

```javascript
// Update total steps
const TOTAL_STEPS = 4; // Was 3

// Add the theme step rendering
{
  step === 2 && (
    <ThemePickerStep
      onComplete={themeId => {
        if (themeId) {
          console.log('Theme selected:', themeId);
        } else {
          console.log('Theme selection skipped');
        }
        setStep(3); // Move to selects
      }}
    />
  );
}

// Shift subsequent steps
{
  step === 3 && <SelectsStep onComplete={() => setStep(4)} />;
}
{
  step === 4 && <SongStep onComplete={handleComplete} />;
}
```

**If using step array pattern:**

```javascript
import ThemePickerStep from '../components/ThemePickerStep';

const steps = [
  { id: 'profile-info', component: ProfileInfoStep },
  { id: 'theme', component: ThemePickerStep }, // NEW
  { id: 'selects', component: SelectsStep },
  { id: 'song', component: SongStep },
];
```

## Step 4: Update Step Indicator

If there's a StepIndicator component or dots showing progress, update the total:

```javascript
// Before
<StepIndicator currentStep={step} totalSteps={3} />

// After
<StepIndicator currentStep={step} totalSteps={4} />
```

Or if using progress dots:

```javascript
// Make sure you have 4 dots now, not 3
```

## Step 5: Handle the onComplete Callback

The `onComplete` callback should:

1. Log the selection (for analytics if needed)
2. Advance to the next step

```javascript
<ThemePickerStep
  onComplete={themeId => {
    // Optional: log for analytics
    if (themeId) {
      logger.info('ProfileSetup: Theme selected', { themeId });
    } else {
      logger.info('ProfileSetup: Theme selection skipped');
    }

    // Advance to next step
    setStep(prev => prev + 1);
    // or
    nextStep();
  }}
/>
```

## Verification Checklist

Test the full onboarding flow (requires fresh account or logout):

### Setup

- [ ] Log out of the app (Settings â†’ Sign Out) or use a new phone number
- [ ] Go through phone verification
- [ ] Start profile setup

### Theme Step Testing

- [ ] Step 1: Enter name, username, bio â†’ Tap "Next"
- [ ] Step 2 should now be Theme Picker
- [ ] "Choose your style" title visible
- [ ] Grid of themes (Dark, Light, Ocean, Forest, Sunset) - no Custom
- [ ] Continue and Skip buttons visible

### Selection Testing

- [ ] Tap "Light" theme
  - [ ] Selection moves to Light
  - [ ] App background changes immediately (preview)
- [ ] Tap "Continue"
  - [ ] Moves to Selects step (photo selection)
- [ ] Complete onboarding normally
- [ ] Verify Light theme is still active
- [ ] Go to Settings â†’ Appearance
  - [ ] Light should be selected

### Skip Testing

- [ ] Log out and restart onboarding
- [ ] At theme step, tap "Skip for now"
- [ ] Should move to next step with Dark theme active
- [ ] Complete onboarding - Dark theme should be applied

### Step Indicator

- [ ] Verify step dots/numbers show correct position
- [ ] "Step 2 of 4" (or appropriate count) displayed

## Key Learnings

1. **Multi-step forms:** Break complex flows into digestible steps
2. **Optional steps:** Provide skip options for non-critical personalization
3. **Instant feedback:** Preview changes before committing
4. **Pattern matching:** Integrate new code following existing patterns

## Phase 25 Complete!

Congratulations! You've completed the entire Color Palette Selection & Customization feature:

### What You Built

1. **ThemeCard component** - Reusable theme preview cards
2. **Theme system** - 5 preset themes with context management
3. **Appearance settings** - Settings UI with preview/apply flow
4. **Custom theme editor** - Color pickers for personalization
5. **Onboarding integration** - Theme selection for new users

### Features Delivered

- 5 preset themes (Dark, Light, Ocean, Forest, Sunset)
- Custom theme editor with 5 customizable colors
- Theme persistence across app restarts
- Settings â†’ Appearance for theme selection
- New user onboarding includes theme picker
- Preview â†’ Apply flow prevents accidental changes

### Files You Created

- `src/constants/themes.js` - Theme definitions
- `src/components/ThemeCard.js` - Theme preview card
- `src/components/ColorPickerRow.js` - Color picker with modal
- `src/components/ThemePickerStep.js` - Onboarding theme picker
- `src/screens/AppearanceSettingsScreen.js` - Settings UI
- `src/screens/CustomThemeEditorScreen.js` - Custom editor

### Files You Modified

- `src/context/ThemeContext.js` - Full theme support
- `src/screens/SettingsScreen.js` - Appearance navigation
- `src/screens/ProfileSetupScreen.js` - Theme onboarding step
- `src/navigation/AppNavigator.js` - New screen registration

### Skills You Learned

- React Native development environment setup
- Component architecture patterns
- Context API for global state
- AsyncStorage for persistence
- Third-party library integration (color picker)
- Multi-step form patterns
- Preview/apply UX patterns
- Navigation and screen registration

---

**Great work!** You've completed Phase 25 and built a production-ready theming feature.

```
  </action>
  <verify>docs/phase-25/06-ONBOARDING.md created</verify>
  <done>Onboarding tutorial created</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] docs/phase-25/06-ONBOARDING.md created
- [ ] ThemePickerStep component documented
- [ ] ProfileSetupScreen integration explained
- [ ] Skip functionality covered
- [ ] Phase 25 completion summary included
</verification>

<success_criteria>
- Junior developer can integrate theme picker into onboarding
- Multi-step form pattern clearly explained
- Complete Phase 25 summary provided
</success_criteria>

<output>
After completion, create `.planning/phases/25-color-palette/25-05-SUMMARY.md`
</output>
```
