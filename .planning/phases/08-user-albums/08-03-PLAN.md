---
phase: 08-user-albums
plan: 03
type: execute
---

<objective>
Implement album creation flow with name input and photo selection.

Purpose: Allow users to create albums by naming them and selecting photos.
Output: Working flow from add button to album creation with photos.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./08-03-SUMMARY.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-user-albums/08-CONTEXT.md
@.planning/phases/08-user-albums/08-01-SUMMARY.md
@.planning/phases/08-user-albums/08-02-SUMMARY.md

@src/screens/ProfileScreen.js
@src/services/firebase/albumService.js
@src/services/firebase/photoService.js
@src/navigation/AppNavigator.js
@src/constants/colors.js

**From context - Album creation specs:**

- Flow: Name first â†’ then select photos
- Must have at least 1 photo to create
- Multi-select from grid of all user's photos (archived + journaled)
- Album name: 24 characters max, required
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Create CreateAlbumScreen</name>
  <files>src/screens/CreateAlbumScreen.js, src/navigation/AppNavigator.js</files>
  <action>
Create CreateAlbumScreen for entering album name.

Screen layout:

- Dark background (colors.background.primary)
- Header: Back button (chevron-back), "New Album" title, empty right space
- Large text input for album name:
  - Placeholder: "Album name"
  - Max 24 characters (show character count: "12/24")
  - Auto-focus on mount
  - Large font (24px), centered, colors.text.primary
  - No border, just underline (colors.border.subtle)
- "Next" button at bottom:
  - Full width, dark theme button style
  - Disabled until name has at least 1 character
  - On press: navigate to AlbumPhotoPicker with albumName param

Navigation setup:

- Add CreateAlbumScreen to AppNavigator stack
- Screen name: 'CreateAlbum'
- Options: headerShown: false (custom header)

Update ProfileScreen:

- handleAddAlbumPress navigates to 'CreateAlbum'
  </action>
  <verify>Tapping add button on profile opens CreateAlbumScreen</verify>
  <done>CreateAlbumScreen shows name input with character counter and Next button</done>
  </task>

<task type="auto">
  <name>Task 2: Create AlbumPhotoPickerScreen</name>
  <files>src/screens/AlbumPhotoPickerScreen.js, src/navigation/AppNavigator.js</files>
  <action>
Create AlbumPhotoPickerScreen for selecting photos to add to album.

Route params:

- `albumName` - Name for new album (from CreateAlbumScreen)
- `existingAlbumId` - Optional, for adding photos to existing album
- `existingPhotoIds` - Optional, array of photo IDs already in album (show as disabled)

Screen layout:

- Header: Back button, "Select Photos" title, "Create" button (or "Add" if existing album)
- Create/Add button disabled until at least 1 photo selected
- 3-column grid of photos (FlatList with numColumns={3})
- Photos: user's triaged photos (status: 'triaged', both journal and archive)
- Each photo cell:
  - Square aspect ratio, 2px gap between cells
  - Tap toggles selection
  - Selected: blue checkmark overlay in top-right corner
  - If in existingPhotoIds: show checkmark but grayed out, not tappable

Data fetching:

- Use getUserPhotos(userId) from photoService
- Filter for status === 'triaged'
- Order by capturedAt desc (newest first)

On Create/Add:

- If new album: call createAlbum(userId, albumName, selectedPhotoIds)
- If existing: call addPhotosToAlbum(existingAlbumId, selectedPhotoIds)
- On success: navigate back to Profile (pop to profile or goBack twice)
- On error: show Alert

Navigation:

- Add AlbumPhotoPickerScreen to AppNavigator
- Screen name: 'AlbumPhotoPicker'
  </action>
  <verify>Can navigate from CreateAlbum to PhotoPicker and see photo grid</verify>
  <done>Photo picker shows grid of triaged photos with multi-select and creates album</done>
  </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete album creation flow from profile to photo selection</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Navigate to Profile tab
    3. Tap the "+" add album button
    4. Verify: CreateAlbumScreen opens with name input
    5. Type an album name, verify character counter works (max 24)
    6. Tap "Next" button
    7. Verify: AlbumPhotoPickerScreen shows grid of your photos
    8. Select 2-3 photos (tap to toggle selection)
    9. Tap "Create" button
    10. Verify: Returns to Profile, new album appears in album bar
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] CreateAlbumScreen with name input and character limit
- [ ] AlbumPhotoPickerScreen with 3-column photo grid
- [ ] Multi-select works with visual feedback
- [ ] Album creation saves to Firestore
- [ ] New album appears in profile album bar
- [ ] No lint errors: `npm run lint`
</verification>

<success_criteria>

- Full create flow works end-to-end
- Name validation enforced (1-24 chars)
- At least 1 photo required
- Album appears immediately after creation
  </success_criteria>

<output>
After completion, create `.planning/phases/08-user-albums/08-03-SUMMARY.md`
</output>
