---
phase: 08-user-albums
plan: 04
type: execute
---

<objective>
Create album grid view screen for browsing album contents.

Purpose: Allow users to view all photos in an album in a grid layout.
Output: AlbumGridScreen with 3-column photo grid and navigation from album cards.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./08-04-SUMMARY.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-user-albums/08-CONTEXT.md
@.planning/phases/08-user-albums/08-03-SUMMARY.md

@src/screens/ProfileScreen.js
@src/services/firebase/albumService.js
@src/services/firebase/photoService.js
@src/navigation/AppNavigator.js
@src/constants/colors.js

**From context - Album grid view specs:**

- Full-screen with back button/gesture to exit
- 3-column grid layout
- Header: album name + photo count + 3-dot menu + back
- Grid 3-dot menu: Rename, Change cover, Delete album, Select mode (editing in 08-06)
- Add photos: button at end of grid + floating button at bottom
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Create AlbumGridScreen</name>
  <files>src/screens/AlbumGridScreen.js, src/navigation/AppNavigator.js</files>
  <action>
Create AlbumGridScreen for viewing album contents.

Route params:

- `albumId` - Album ID to display
- `isOwnProfile` - Boolean for showing edit options

Screen layout:

- Dark background (colors.background.primary)
- Header (absolute positioned like ProfileScreen):
  - Left: Back button (chevron-back)
  - Center: Album name
  - Right: 3-dot menu (ellipsis-horizontal) - only if isOwnProfile
- Below header: Photo count text ("12 photos", colors.text.secondary)
- 3-column FlatList grid:
  - Square cells with 2px gap
  - Photos ordered newest first (use photoIds order from album, fetch photo docs for URLs)
  - Tap photo: navigate to AlbumPhotoViewer (08-05, stub for now with log)
- If isOwnProfile: "Add Photos" button at end of grid
  - Same cell size as photos
  - Dashed border, plus icon, "Add" text
  - On tap: navigate to AlbumPhotoPicker with existingAlbumId

3-dot menu (Alert.alert for now, actions in 08-06):

- "Rename Album"
- "Change Cover"
- "Delete Album" (destructive style)
- "Cancel"

Data fetching:

- getAlbum(albumId) for album document
- Batch fetch photo documents for photoIds to get imageURLs
- Consider creating helper: getPhotosByIds(photoIds) in photoService

Navigation:

- Add AlbumGridScreen to AppNavigator
- Screen name: 'AlbumGrid'
  </action>
  <verify>Screen renders with album name and photo grid</verify>
  <done>AlbumGridScreen shows 3-column grid with header and menu stub</done>
  </task>

<task type="auto">
  <name>Task 2: Wire up navigation from AlbumCard to AlbumGridScreen</name>
  <files>src/screens/ProfileScreen.js, src/components/AlbumBar.js</files>
  <action>
Connect album card taps to open album grid.

In ProfileScreen:

- Update handleAlbumPress to navigate:

```javascript
const handleAlbumPress = album => {
  logger.info('ProfileScreen: Album pressed', { albumId: album.id });
  navigation.navigate('AlbumGrid', {
    albumId: album.id,
    isOwnProfile: isOwnProfile,
  });
};
```

Also need to resolve cover photo URLs for AlbumBar:

- After fetching albums, batch fetch the cover photos to get URLs
- Create a photoUrls map: { [photoId]: imageURL }
- Pass to AlbumBar component

Add helper function or use existing pattern to fetch multiple photos by ID:

- If getPhotosByIds doesn't exist, fetch individually and combine
- Store in state: `const [coverPhotoUrls, setCoverPhotoUrls] = useState({})`
  </action>
  <verify>Tapping album card navigates to AlbumGridScreen</verify>
  <done>Album cards show cover photos and navigate to grid on tap</done>
  </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Album grid view with navigation from profile album bar</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Create an album with a few photos if you don't have one
    3. On Profile, verify album card shows cover photo
    4. Tap the album card
    5. Verify: AlbumGridScreen opens with album name in header
    6. Verify: Photo count shows correctly ("3 photos")
    7. Verify: 3-column grid displays all album photos
    8. Verify: 3-dot menu shows options (even if they don't work yet)
    9. Verify: "Add Photos" button appears at end of grid
    10. Tap back button, verify returns to Profile
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] AlbumGridScreen created with header and 3-column grid
- [ ] Album data fetched and photos displayed
- [ ] Cover photos resolve and show on AlbumCard
- [ ] Navigation works: AlbumCard tap â†’ AlbumGridScreen
- [ ] 3-dot menu shows (actions are stubs)
- [ ] Add Photos button navigates to picker
- [ ] No lint errors: `npm run lint`
</verification>

<success_criteria>

- Can view album contents in grid
- Navigation flows work
- Cover photos display correctly
- Ready for photo viewer (08-05)
  </success_criteria>

<output>
After completion, create `.planning/phases/08-user-albums/08-04-SUMMARY.md`
</output>
