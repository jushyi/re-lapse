---
phase: 32-navigation-restructure
plan: 01
type: execute
---

<objective>
Restructure from 4 tabs to 3 tabs: Feed | Camera | Profile (Instagram-style layout)

Purpose: Simplify navigation, reduce clutter, prepare for Phase 33 activity page integration
Output: AppNavigator.js with 3-tab layout, Friends screens relocated to root stack
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-navigation-restructure/32-CONTEXT.md

# Prior phase context

@.planning/phases/31-personalization-scaffolding/31-01-SUMMARY.md

# Key source file

@src/navigation/AppNavigator.js

**Context from Phase 32 discussion:**

- 3-tab layout: Feed (left), Camera (center), Profile (right)
- Camera stays visually consistent with other tabs (not elevated)
- Friends tab removed entirely - functionality moves to activity page in Phase 33
- No visual redesign - just restructure the tabs

**Constraining decisions:**

- Camera must remain initialRouteName (capture-first philosophy)
- Friends screens (FriendsList, UserSearch, FriendRequests) must remain accessible for Phase 33
- Deep linking must be updated to reflect new structure
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Remove Friends tab and restructure to 3-tab layout</name>
  <files>src/navigation/AppNavigator.js</files>
  <action>
    In MainTabNavigator:
    1. Remove the Friends Tab.Screen entry (lines 129-135)
    2. Verify tab order is: Feed, Camera, Profile (Camera in center position)
    3. Delete FriendsStackNavigator function (lines 40-52) - no longer needed as nested navigator
    4. Delete FriendsIcon component (lines 197-209) - no longer used after tab removal
    5. Keep darkroomCount useEffect for now (may be cleaned up in future phase)

    Do NOT delete FriendsListScreen, UserSearchScreen, FriendRequestsScreen imports - they're used in Task 2.

  </action>
  <verify>App builds without errors: `cd lapse-clone-app && npx expo start --clear` launches without crashes</verify>
  <done>Tab bar shows exactly 3 tabs: Feed | Camera | Profile. Camera remains initialRouteName.</done>
</task>

<task type="auto">
  <name>Task 2: Relocate Friends screens to root stack and update deep linking</name>
  <files>src/navigation/AppNavigator.js</files>
  <action>
    1. In the main Stack.Navigator (inside authenticated section with MainTabs, Darkroom, etc.):
       Add after Notifications screen:
       ```jsx
       <Stack.Screen
         name="FriendsList"
         component={FriendsListScreen}
         options={{
           presentation: 'card',
           animation: 'slide_from_right',
         }}
       />
       <Stack.Screen
         name="UserSearch"
         component={UserSearchScreen}
         options={{
           presentation: 'card',
           animation: 'slide_from_right',
         }}
       />
       <Stack.Screen
         name="FriendRequests"
         component={FriendRequestsScreen}
         options={{
           presentation: 'card',
           animation: 'slide_from_right',
         }}
       />
       ```

    2. Update deep linking config:
       - Remove the Friends nested routes from MainTabs.screens
       - Add root-level routes for the friends screens:
         ```js
         FriendsList: 'friends',
         UserSearch: 'friends/search',
         FriendRequests: 'friends/requests',
         ```

    This allows Phase 33 to navigate to these screens from the activity page.

  </action>
  <verify>
    - Deep link test: `npx uri-scheme open "lapse://friends/requests" --ios` opens FriendRequests screen
    - Navigation from ProfileScreen to friends (if applicable) still works
  </verify>
  <done>Friends screens accessible as root stack screens. Deep links updated. No broken navigation references.</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] App launches with 3 tabs visible: Feed, Camera, Profile
- [ ] Camera tab is in center position and is the initial route
- [ ] No ESLint errors: `npm run lint`
- [ ] FriendsList, UserSearch, FriendRequests screens accessible via `navigation.navigate('FriendsList')` etc.
- [ ] No console warnings about missing screens or navigation
</verification>

<success_criteria>

- Tab bar restructured from 4 tabs to 3 tabs
- Camera remains center tab and initial route
- Friends screens relocated to root stack (accessible for Phase 33 integration)
- Deep linking config updated
- No TypeScript/ESLint errors
- All verification checks pass
  </success_criteria>

<output>
After completion, create `.planning/phases/32-navigation-restructure/32-01-SUMMARY.md` following the summary template with:
- Accomplishments (tab restructure, screen relocation)
- Files modified (AppNavigator.js)
- Decisions made (if any deviations)
- Issues encountered
- Next phase readiness (Phase 33: Feed Header & Notifications)
</output>
