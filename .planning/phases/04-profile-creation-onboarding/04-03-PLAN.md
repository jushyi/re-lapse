---
phase: 04-profile-creation-onboarding
plan: 03
type: execute
---

<objective>
Implement drag-to-reorder functionality for thumbnail strip with delete bar that appears when dragging.

Purpose: Allow users to reorder their highlight photos by dragging and delete by dragging to a delete zone.
Output: Draggable thumbnails with reorder and drag-to-delete functionality.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-profile-creation-onboarding/04-CONTEXT.md
@.planning/phases/04-profile-creation-onboarding/04-01-PLAN.md
@.planning/phases/04-profile-creation-onboarding/04-02-PLAN.md

**Key files:**
@src/screens/SelectsScreen.js
@src/constants/colors.js

**Available libraries (already installed):**

- react-native-gesture-handler (~2.28.0)
- react-native-reanimated (~4.1.1)

**From 04-CONTEXT.md:**

- Users can drag thumbnails to reorder them
- When dragging, a red delete bar with trash icon appears below
- Dropping a photo on delete bar removes it
- This replaces the X button removal from 04-02
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Implement draggable thumbnails with reorder</name>
  <files>src/screens/SelectsScreen.js</files>
  <action>
Implement drag-to-reorder for the thumbnail strip using react-native-gesture-handler and react-native-reanimated.

**Approach: Use Gesture Detector with Pan gesture for each thumbnail**

**Imports to add:**

```javascript
import { GestureDetector, Gesture, GestureHandlerRootView } from 'react-native-gesture-handler';
import Animated, {
  useAnimatedStyle,
  useSharedValue,
  withSpring,
  runOnJS,
} from 'react-native-reanimated';
```

**State additions:**

- draggingIndex: number | null (which thumbnail is being dragged)
- Use useSharedValue for drag offset tracking

**Create DraggableThumbnail component (inline or extract):**

Props: photo, index, onReorder, onDragStart, onDragEnd, isSelected, onPress

Implementation:

- Wrap thumbnail in GestureDetector with Pan gesture
- Track translateX during drag with useSharedValue
- On drag start: call onDragStart(index)
- During drag: update translateX
- On drag end:
  - Calculate target index based on translateX
  - Call onReorder(fromIndex, toIndex) if position changed
  - Reset translateX with withSpring
  - Call onDragEnd()

**Reorder logic in SelectsScreen:**

handleReorder(fromIndex, toIndex):

- Create new array with item moved from fromIndex to toIndex
- Update selectedPhotos state
- If selectedIndex was the moved item, update to new position
- If selectedIndex was in the affected range, adjust accordingly

**Visual feedback during drag:**

- Dragged thumbnail scales up slightly (transform: scale(1.1))
- Other thumbnails have reduced opacity (0.6)
- Use Animated.View for smooth transitions

**Important:** Wrap the entire screen content in GestureHandlerRootView

**Note:** Keep the existing tap functionality - short taps should still select the thumbnail for preview. Use gesture handler's activation constraints to distinguish tap vs drag.
</action>
<verify>

1. Long press and drag a thumbnail horizontally
2. Thumbnail follows finger, other thumbnails shift to show drop position
3. Release - thumbnail snaps to new position
4. Array order is updated (verify by checking preview when tapping)
   </verify>
   <done>Thumbnails can be dragged and reordered, visual feedback shows during drag, array updates correctly</done>
   </task>

<task type="auto">
  <name>Task 2: Add delete bar that appears when dragging</name>
  <files>src/screens/SelectsScreen.js</files>
  <action>
Add a delete zone that appears when dragging a thumbnail.

**Delete bar design:**

- Appears at bottom of thumbnail strip area (or between thumbnails and button)
- Height: 48px
- Background: colors.status.danger with 0.9 opacity
- Content: Ionicons "trash-outline" + "Drop to remove" text
- Border radius: 8
- Initially hidden (height 0 or translateY off screen)

**State:**

- isDragging: boolean (true when any thumbnail is being dragged)
- isOverDeleteZone: boolean (true when dragged item is over delete bar)

**Animation:**

- When isDragging becomes true: animate delete bar sliding up from bottom
- When isDragging becomes false: animate delete bar sliding back down
- Use withSpring or withTiming for smooth animation

**Delete zone detection:**

- Track Y position of dragged thumbnail
- If Y position puts thumbnail over delete bar (check overlap), set isOverDeleteZone true
- When isOverDeleteZone: delete bar changes appearance (brighter red, scale up slightly)

**Drop on delete:**

- On drag end, if isOverDeleteZone is true:
  - Remove the photo from selectedPhotos array
  - Show brief haptic feedback (if available)
  - Update selectedIndex if needed
- Don't call reorder logic if deleting

**Remove the X button:**

- Remove the X button overlay from thumbnails (deletion is now drag-to-delete only)
- Cleaner UI without X buttons cluttering thumbnails

**Visual states:**

- Normal drag: delete bar visible with standard styling
- Hovering over delete: delete bar brightens, maybe slight scale, text changes to "Release to delete"
  </action>
  <verify>

1. Start dragging a thumbnail - delete bar slides up from bottom
2. Drag thumbnail downward toward delete bar - bar highlights when over it
3. Drop on delete bar - photo is removed
4. Stop dragging (drop elsewhere) - delete bar slides away
5. Confirm: no X buttons on thumbnails anymore
   </verify>
   <done>Delete bar appears when dragging, highlights when hovering, removes photo when dropped on it, X buttons removed</done>
   </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Drag-to-reorder thumbnails with delete bar that appears when dragging</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Navigate to SelectsScreen with some photos already selected (or add 3-4 photos)
    3. Long press on a thumbnail - should start dragging
    4. Drag horizontally - thumbnail follows, other thumbnails shift
    5. Release - thumbnail snaps to new position
    6. Verify: tap thumbnails to confirm order matches (preview should show correct photo)
    7. Start dragging again - delete bar should appear at bottom
    8. Drag down toward delete bar - bar should highlight/change when hovering
    9. Drop on delete bar - photo should be removed
    10. Confirm: no X buttons visible on thumbnails
    11. Add 10 photos, reorder them, delete a few - all interactions smooth
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Thumbnails can be dragged horizontally
- [ ] Reorder updates the array correctly
- [ ] Visual feedback during drag (scale, opacity changes)
- [ ] Delete bar appears when dragging
- [ ] Delete bar highlights when thumbnail hovers over it
- [ ] Dropping on delete bar removes the photo
- [ ] X buttons removed from thumbnails
- [ ] Short taps still work for preview selection
- [ ] No crashes or jank during interactions
</verification>

<success_criteria>

- Drag-to-reorder fully functional
- Delete bar appears during drag and works correctly
- Smooth animations throughout
- X button removal (drag-to-delete replaces it)
- Tap-to-preview still works (gesture conflict resolved)
  </success_criteria>

<output>
After completion, create `.planning/phases/04-profile-creation-onboarding/04-03-SUMMARY.md`
</output>
