---
phase: 04-profile-creation-onboarding
plan: 04
type: execute
---

<objective>
Add tutorial hint for drag interaction, skip confirmation popup, load existing selects when returning, and final polish.

Purpose: Complete the SelectsScreen UX with onboarding guidance, proper skip flow, and edit capability.
Output: Tutorial popup, skip confirmation, persisted hint state, and ability to edit existing selects.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-profile-creation-onboarding/04-CONTEXT.md
@.planning/phases/04-profile-creation-onboarding/04-01-PLAN.md
@.planning/phases/04-profile-creation-onboarding/04-02-PLAN.md
@.planning/phases/04-profile-creation-onboarding/04-03-PLAN.md

**Key files:**
@src/screens/SelectsScreen.js
@src/context/AuthContext.js
@src/constants/colors.js

**From 04-CONTEXT.md:**

- Hint popup + pulling animation to teach drag-and-drop
- Hint shows every visit until user actually performs a drag action
- Skip confirmation: "Are you sure you want to skip selecting highlights? This can always be done later in the profile tab" with Cancel and Skip options
- Selects persist - returning to the screen loads previously saved photos for editing
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Add tutorial hint popup with animation</name>
  <files>src/screens/SelectsScreen.js</files>
  <action>
Add a tutorial hint that teaches users about drag-to-reorder and drag-to-delete.

**State:**

- showDragHint: boolean (true initially if user hasn't performed a drag before)
- hasUserDragged: boolean (tracks if user has ever dragged - persisted via AsyncStorage)

**AsyncStorage key:** '@selects_drag_hint_dismissed'

**On mount:**

- Check AsyncStorage for dismiss flag
- If not dismissed, set showDragHint to true after 1 second delay (let screen load first)

**Hint popup design:**

- Positioned over the thumbnail strip area
- Semi-transparent dark overlay behind it
- Rounded container with:
  - Illustration/animation: subtle pulsing hand icon or arrow showing drag motion
  - Text: "Drag to reorder" with smaller text "Drag down to delete"
  - "Got it" button to dismiss
- Use Animated for fade-in effect

**Auto-dismiss on first drag:**

- When user starts their first drag (onDragStart), immediately:
  - Set showDragHint to false
  - Save dismiss flag to AsyncStorage
  - Set hasUserDragged to true

**Manual dismiss:**

- "Got it" button:
  - Set showDragHint to false
  - Save dismiss flag to AsyncStorage

**Animation suggestion:**

- Subtle looping animation showing a thumbnail moving left/right
- Or just a hand icon with arrow indicating drag direction
- Keep it simple - can use Lottie later if needed, but start with basic Animated

**Important:** Don't block interactions - user can still tap thumbnails even with hint visible. Hint auto-dismisses when they actually drag.
</action>
<verify>

1. Fresh app or clear AsyncStorage
2. Navigate to SelectsScreen with photos
3. After 1 second, hint popup should appear
4. Tap "Got it" - hint dismisses
5. Leave and return - hint should NOT appear (was dismissed)
6. Clear AsyncStorage, return - hint appears again
7. Start dragging a thumbnail - hint auto-dismisses
   </verify>
   <done>Tutorial hint popup appears on first visits, can be dismissed manually or auto-dismisses on first drag, state persists in AsyncStorage</done>
   </task>

<task type="auto">
  <name>Task 2: Skip confirmation and load existing selects</name>
  <files>src/screens/SelectsScreen.js</files>
  <action>
**Skip confirmation popup:**

Add back a skip option with confirmation:

1. Add "Skip for now" text below the "Complete Profile Setup" button:
   - Style: underlined text, colors.text.secondary, marginTop: 16

2. handleSkip function:
   - If selectedPhotos.length === 0:
     - Show Alert.alert with:
       - Title: "Skip Highlights?"
       - Message: "Are you sure you want to skip selecting highlights? You can always add them later from your profile."
       - Buttons: [
         { text: "Cancel", style: "cancel" },
         { text: "Skip", onPress: confirmSkip, style: "destructive" }
         ]
   - If selectedPhotos.length > 0:
     - Just complete with current selection (no confirmation needed if they have photos)

3. confirmSkip function:
   - Save empty selects to Firestore (selectsCompleted: true, selects: [])
   - Update local profile state
   - Navigation handled automatically

**Load existing selects when returning:**

When user returns to SelectsScreen (from profile settings, for editing):

1. On component mount, check userProfile.selects:
   - If userProfile.selects exists and has items:
     - Initialize selectedPhotos state with those URIs
     - Format: selectedPhotos = userProfile.selects.map((uri, i) => ({ uri, assetId: `existing_${i}` }))

2. Update useEffect to run on mount:

   ```javascript
   useEffect(() => {
     if (userProfile?.selects?.length > 0) {
       const existingPhotos = userProfile.selects.map((uri, index) => ({
         uri,
         assetId: `existing_${index}`,
       }));
       setSelectedPhotos(existingPhotos);
     }
   }, []); // Run once on mount
   ```

3. This allows users to:
   - See their previously saved selects
   - Add more photos
   - Reorder them
   - Remove some
   - Save updated selection

**Button text update:**

- If editing existing (came from profile, already has selectsCompleted): "Save Changes"
- If initial setup: "Complete Profile Setup"

Add prop or detect via navigation params or userProfile.selectsCompleted to know if editing.
</action>
<verify>

1. Fresh user flow - no photos selected, tap "Skip for now"
2. Confirmation popup appears with correct text
3. Tap Cancel - stays on screen
4. Tap Skip - proceeds to main app with empty selects
5. Go to profile, edit selects (need nav from profile - may need to test manually)
6. Existing selects should load
7. Make changes, save - updates correctly
   </verify>
   <done>Skip confirmation shows when no photos selected, existing selects load when returning to screen for editing, button text reflects context</done>
   </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Tutorial hint popup, skip confirmation, and ability to load/edit existing selects</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Clear AsyncStorage if needed for fresh test
    3. Navigate to SelectsScreen (complete profile setup first)
    4. After ~1 second, tutorial hint should appear
    5. Tap "Got it" - hint dismisses
    6. Leave screen and return - hint should NOT appear again
    7. With no photos selected, tap "Skip for now"
    8. Confirmation popup: "Skip Highlights?" should appear
    9. Tap Cancel - stays on screen
    10. Tap Skip - proceeds to main app
    11. Add some selects and complete
    12. Return to SelectsScreen (from profile if navigation exists, or reset flow)
    13. Existing photos should be loaded
    14. Make changes and save - should work correctly
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Tutorial hint appears on first visit
- [ ] Hint can be dismissed with "Got it" button
- [ ] Hint auto-dismisses when user starts dragging
- [ ] Hint state persists in AsyncStorage
- [ ] "Skip for now" shows confirmation when no photos selected
- [ ] Skip confirmation has correct text and buttons
- [ ] Existing selects load when returning to screen
- [ ] Button text appropriate for context (Complete vs Save)
- [ ] Full flow works end-to-end
</verification>

<success_criteria>

- Tutorial hint implemented with persistence
- Skip confirmation popup working
- Existing selects load for editing
- Phase 4 complete - full profile onboarding flow polished
  </success_criteria>

<output>
After completion, create `.planning/phases/04-profile-creation-onboarding/04-04-SUMMARY.md`:

# Phase 4 Plan 4: Tutorial & Final Polish Summary

**[Summary of tutorial, skip confirmation, and edit functionality]**

## Phase Complete

Phase 4: Profile Creation Onboarding is complete. The profile setup flow now includes:

- StepIndicator showing progress (1 of 2, 2 of 2)
- ProfileSetupScreen with single "Next step" button
- Redesigned SelectsScreen with preview and 10 thumbnail slots
- Drag-to-reorder with delete bar
- Tutorial hint for drag interactions
- Skip confirmation when no photos selected
- Ability to edit existing selects

Ready for Phase 5: Profile Screen Layout
</output>
