---
phase: 04-profile-creation-onboarding
plan: 01
type: execute
---

<objective>
Add step indicator component and update ProfileSetupScreen to show step dots and use a single "Next step" button that validates required fields before proceeding.

Purpose: Create a unified onboarding feel where ProfileSetupScreen and SelectsScreen are clearly step 1 and step 2 of a cohesive flow.
Output: Reusable StepIndicator component, updated ProfileSetupScreen with step dots (1 of 2) and "Next step" button.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-profile-creation-onboarding/04-CONTEXT.md
@.planning/phases/03-signup-flow-refactor/03-02-SUMMARY.md
@.planning/phases/3.1-auth-input-fixes/03.1-01-SUMMARY.md

**Key files:**
@src/screens/ProfileSetupScreen.js
@src/screens/SelectsScreen.js
@src/navigation/AppNavigator.js
@src/constants/colors.js

**From prior phases:**

- ProfileSetupScreen has validation for username and displayName
- SelectsScreen sets selectsCompleted flag for navigation
- Conditional navigator rendering handles auth flow transitions

**From 04-CONTEXT.md:**

- Consolidate "Complete Setup" + "Skip" into single "Next step" button
- Add step dots at top (1 of 2)
- Validation for required fields (displayName, username) - if fail, outline red + alert
- Smooth horizontal slide animation to SelectsScreen
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Create StepIndicator component</name>
  <files>src/components/StepIndicator.js, src/components/index.js</files>
  <action>
Create a reusable StepIndicator component that displays progress dots for multi-step flows.

Props:

- currentStep: number (1-based index of current step)
- totalSteps: number (total number of steps)

Design:

- Horizontal row of dots
- Current step dot: filled with colors.brand.primary (or white)
- Other dots: outline only with colors.text.tertiary
- Dot size: 8px diameter
- Gap between dots: 8px
- Text below: "Step X of Y" in colors.text.secondary, fontSize 12

Use StyleSheet.create for styles. Follow existing component patterns (default export, use colors.js constants).

Export from src/components/index.js barrel file.
</action>
<verify>Import StepIndicator in ProfileSetupScreen - no import errors</verify>
<done>StepIndicator component created, exported, shows dots and "Step X of Y" text</done>
</task>

<task type="auto">
  <name>Task 2: Update ProfileSetupScreen with step indicator and Next button</name>
  <files>src/screens/ProfileSetupScreen.js, src/navigation/AppNavigator.js</files>
  <action>
**ProfileSetupScreen changes:**

1. Add StepIndicator at top below SafeAreaView, before title:
   - currentStep={1} totalSteps={2}
   - Add marginBottom: 16 below indicator

2. Replace two buttons ("Complete Setup" + "Skip for now") with single "Next step" button:
   - Keep the handleCompleteSetup logic but rename to handleNextStep
   - Remove the skip button and handleSkip function entirely
   - Button title: "Next step"
   - On press: validate required fields (username, displayName)
   - If validation fails: highlight invalid fields in red (Input already supports error prop), show Alert with "Please fill in required fields"
   - If validation passes: save profile data to Firestore with profileSetupCompleted: true, then navigation happens automatically via conditional rendering

3. Update validation flow:
   - The existing validate() function checks all fields
   - Create validateRequired() to check only username and displayName (already exists, keep it)
   - handleNextStep calls validate() which includes required field check

4. Remove the "Skip for now" text button entirely

**AppNavigator changes:**

The navigation already handles ProfileSetup → Selects transition via conditional rendering (needsProfileSetup → needsSelects). The slide animation is already 'slide_from_right' default. No changes needed to AppNavigator.

**Important:** Keep all existing profile data saving logic (photo upload, bio, song) - just consolidate into one flow triggered by "Next step".
</action>
<verify>npm start - ProfileSetupScreen shows step indicator (1 of 2), has only "Next step" button, validates required fields before proceeding</verify>
<done>ProfileSetupScreen displays StepIndicator showing "Step 1 of 2", has single "Next step" button that validates required fields and proceeds to SelectsScreen on success</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>StepIndicator component and updated ProfileSetupScreen with step dots and single "Next step" button</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Log out if needed to reach signup flow, or use fresh phone number
    3. Complete phone verification to reach ProfileSetupScreen
    4. Confirm: Step indicator shows "Step 1 of 2" with first dot highlighted
    5. Try tapping "Next step" with empty fields - should show validation errors
    6. Fill in display name and username
    7. Tap "Next step" - should smoothly transition to SelectsScreen
    8. Confirm: No "Skip for now" option on ProfileSetupScreen
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] StepIndicator component exists and exports from components/index.js
- [ ] ProfileSetupScreen imports and displays StepIndicator
- [ ] ProfileSetupScreen has only "Next step" button (no skip option)
- [ ] Validation prevents proceeding without required fields
- [ ] Transition to SelectsScreen works after validation passes
- [ ] No TypeScript/lint errors
</verification>

<success_criteria>

- StepIndicator component created and reusable
- ProfileSetupScreen shows "Step 1 of 2" indicator
- Single "Next step" button replaces Complete + Skip buttons
- Required field validation works (username, displayName)
- Smooth transition to SelectsScreen on valid submission
  </success_criteria>

<output>
After completion, create `.planning/phases/04-profile-creation-onboarding/04-01-SUMMARY.md`
</output>
