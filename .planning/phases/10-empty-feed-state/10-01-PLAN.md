---
phase: 10-empty-feed-state
plan: 01
type: execute
---

<objective>
Implement contextual empty feed states that guide users toward meaningful actions.

Purpose: New users see prompts to add friends and take their first photo. Established users with friends but empty feeds see an encouraging message.
Output: Two distinct empty states with navigation to friends screen and camera.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-empty-feed-state/10-CONTEXT.md

**Key files:**
@src/screens/FeedScreen.js
@src/services/firebase/feedService.js
@src/components/FriendStoryCard.js
@src/styles/FeedPhotoCard.styles.js

**Relevant patterns:**

- FriendStoryCard uses rectangular cards (88x130) with gradient borders
- FeedPhotoCard uses full-width square photos with info row below
- feedService returns { success, data } pattern
- Navigation: 'FriendsList' for friends screen, 'Camera' tab for camera
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Update feedService to return friend count</name>
  <files>src/services/firebase/feedService.js</files>
  <action>
Modify `getFriendStoriesData` to return `totalFriendCount` alongside `friendStories`.

Current return: `{ success: true, friendStories: [] }`
New return: `{ success: true, friendStories: [], totalFriendCount: number }`

The function already fetches `friendUserIds` internally (line ~454). Add `totalFriendCount: friendUserIds.length` to the return object. This enables FeedScreen to distinguish between "no friends" (count=0) vs "friends but no posts" (count>0, friendStories empty).

Also return totalFriendCount in the error/early-return cases:

- No friends found: `{ success: true, friendStories: [], totalFriendCount: 0 }`
- Error case: include `totalFriendCount: 0`
  </action>
  <verify>Review the updated function returns the new structure. No runtime test needed - this is a non-breaking addition.</verify>
  <done>getFriendStoriesData returns totalFriendCount in all code paths</done>
  </task>

<task type="auto">
  <name>Task 2: Create empty state prompt components</name>
  <files>src/components/AddFriendsPromptCard.js, src/components/TakeFirstPhotoCard.js</files>
  <action>
**AddFriendsPromptCard.js:**
Match FriendStoryCard dimensions (88x130 card) but with:
- Dashed border instead of gradient (matches existing empty state patterns like SelectsScreen)
- Plus icon (Ionicons "add") centered in the card area
- "Add friends" label below (matching FriendStoryCard name style)
- onPress prop that navigates to friends screen

**TakeFirstPhotoCard.js:**
Match FeedPhotoCard layout (full-width square) but styled as a prompt:

- Dashed border container (similar to AddFriendsPromptCard)
- Camera icon (Ionicons "camera-outline") centered
- "Take your first photo" text below icon
- onPress prop that navigates to camera

Both components:

- Use colors from constants/colors.js
- Use dark theme styling (colors.background.tertiary for borders, colors.text.secondary for icons/text)
- Export default for consistency with other components
  </action>
  <verify>Both component files exist with proper structure, no syntax errors.</verify>
  <done>AddFriendsPromptCard and TakeFirstPhotoCard components created with matching app styling</done>
  </task>

<task type="auto">
  <name>Task 3: Update FeedScreen with contextual empty states</name>
  <files>src/screens/FeedScreen.js</files>
  <action>
**1. Import new components:**
```javascript
import AddFriendsPromptCard from '../components/AddFriendsPromptCard';
import TakeFirstPhotoCard from '../components/TakeFirstPhotoCard';
```

**2. Add totalFriendCount state:**

```javascript
const [totalFriendCount, setTotalFriendCount] = useState(0);
```

**3. Update loadFriendStories to capture friend count:**
In the `loadFriendStories` function, extract totalFriendCount from result:

```javascript
if (result.success) {
  setFriendStories(result.friendStories);
  setTotalFriendCount(result.totalFriendCount || 0);
}
```

**4. Update renderStoriesRow:**
Currently returns null when friendStories.length === 0. Change to:

- If totalFriendCount === 0: Show AddFriendsPromptCard in the stories container
- If totalFriendCount > 0 but friendStories.length === 0: Return null (friends exist but no photos - handled in empty state)
- Otherwise: Show existing friend story cards

The AddFriendsPromptCard should appear in the same ScrollView container as normal story cards, positioned as if it were a single story card.

**5. Update renderEmptyState:**
Change the empty state content based on context:

- If loading: return null (existing)
- If totalFriendCount === 0: Show TakeFirstPhotoCard (new user - no friends, needs to take photo)
- If totalFriendCount > 0 but photos.length === 0: Show sad emoji state ("Nothing yet, tell your friends to post")

Use existing sad react emoji or Ionicons "sad-outline" with the message.

**Navigation handlers:**

- AddFriendsPromptCard onPress: navigation.navigate('FriendsList')
- TakeFirstPhotoCard onPress: navigation.navigate('Camera')
  </action>
  <verify>

1. New user state (no friends): Stories bar shows "Add friends" prompt, feed area shows "Take your first photo" card
2. Established user state (has friends, no posts): Stories bar is empty, feed shows sad emoji with "Nothing yet, tell your friends to post"
3. Normal state (has friends with photos): Existing behavior unchanged
   </verify>
   <done>FeedScreen shows contextual empty states based on friend count and photo availability</done>
   </task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run lint` passes without errors
- [ ] App loads without crashes
- [ ] New user empty state shows both prompts correctly
- [ ] Established user empty state shows encouraging message
- [ ] Tapping "Add friends" navigates to FriendsList screen
- [ ] Tapping "Take your first photo" navigates to Camera tab
- [ ] Normal feed with friends/photos works unchanged
</verification>

<success_criteria>

- All tasks completed
- Both empty state scenarios work correctly
- Navigation from prompts works
- No TypeScript/lint errors
- Existing feed functionality unchanged
  </success_criteria>

<output>
After completion, create `.planning/phases/10-empty-feed-state/10-01-SUMMARY.md`:

# Phase 10 Plan 01: Empty Feed State UI Summary

**[One-liner describing what shipped]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- `path/to/file.js` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase complete, ready for Phase 11
</output>
