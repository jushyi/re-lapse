# Milestone v1.6: Auth & Profile Refactor

**Status:** SHIPPED 2026-02-06
**Phases:** 1-31 (+ 14 decimal insertions)
**Total Plans:** 108

## Overview

Transform Lapse Clone's authentication experience and profile system from inconsistent placeholders into polished, cohesive screens that match the app's established dark aesthetic. This journey starts with shared auth components, refactors login/signup flows, extends onboarding to capture full profile data, and builds out the profile screen with Selects banner, profile song, and album galleries.

## Phases

### Phase 1: Auth Shared Components

**Goal**: Establish dark theme foundation with shared styles, colors, typography, and reusable components (buttons, inputs, headers) for all auth screens
**Depends on**: Nothing (first phase)
**Plans**: 1/1 complete

Plans:

- [x] 01-01: Dark theme Button/Input updates + AuthCodeInput component

### Phase 2: Login Screen Refactor

**Goal**: Apply dark theme to login screen, improve UX to match app aesthetic
**Depends on**: Phase 1
**Plans**: 1/1 complete

Plans:

- [x] 02-01: Integrate AuthCodeInput into VerificationScreen + dark theme consistency

### Phase 3: Signup Flow Refactor

**Goal**: Refactor signup into multi-step flow with consistent dark styling and clear progression
**Depends on**: Phase 1
**Plans**: 2/2 complete

Plans:

- [x] 03-01: Add profile song section to ProfileSetupScreen
- [x] 03-02: Create SelectsScreen + update navigation flow

### Phase 3.1: Auth Input Field Fixes (INSERTED)

**Goal**: Fix phone number field backspace issue with parenthesis formatting and remove auto-filled letters from profile setup inputs
**Depends on**: Phase 3
**Plans**: 1/1 complete

Plans:

- [x] 03.1-01: Fix phone backspace + profile input initialization

### Phase 4: Profile Creation Onboarding

**Goal**: Polish profile onboarding with step indicators, redesigned SelectsScreen with preview/thumbnails, drag-to-reorder, and tutorial hints
**Depends on**: Phase 3.1
**Plans**: 4/4 complete

Plans:

- [x] 04-01: Step Indicator component + ProfileSetupScreen UX updates
- [x] 04-02: SelectsScreen layout redesign (large preview, 10 thumbnail slots)
- [x] 04-03: Drag-to-reorder implementation with delete bar
- [x] 04-04: Tutorial hint popup, skip confirmation, load existing selects

### Phase 4.1: Drag-Reorder Visual Feedback (INSERTED)

**Goal**: Improve drag-to-reorder UX with animated thumbnail repositioning
**Depends on**: Phase 4
**Plans**: 1/1 complete (+ 1 FIX)

Plans:

- [x] 04.1-01: Animated thumbnail repositioning + verification
- [x] 04.1-01-FIX: Animation timing fixes

### Phase 5: Profile Screen Layout

**Goal**: Build core profile screen layout with profile info display
**Depends on**: Phase 4.1
**Plans**: 2/2 complete

Plans:

- [x] 05-01: Core layout (header, Selects placeholder, overlapping profile photo, info section)
- [x] 05-02: Profile integration (nav bar thumbnail, other user profile adaptation)

### Phase 6: Selects Banner

**Goal**: Implement user-selected photos quick slideshow at top of profile
**Depends on**: Phase 5
**Plans**: 2/2 complete (+ 1 FIX)

Plans:

- [x] 06-01: SelectsBanner component with auto-play, hold-to-pause
- [x] 06-02: Fullscreen view + edit mode navigation
- [x] 06-02-FIX: Modal safe area handling

### Phase 7: Profile Song Scaffold

**Goal**: Scaffold music preview feature with tap-to-play (iTunes 30s previews)
**Depends on**: Phase 5
**Plans**: 5/5 complete (+ 2 FIX)

Plans:

- [x] 07-01: Audio infrastructure (iTunes service + audio player)
- [x] 07-02: ProfileSongCard component + ProfileScreen integration
- [x] 07-03: Song search modal
- [x] 07-04: Clip selection with WaveformScrubber
- [x] 07-04-FIX: UX fixes (partial height modal, playback indicator)
- [x] 07-04-FIX2: Silent mode audio + smooth animations
- [x] 07-05: Full integration (setup screen, edit menu, navigation cleanup)

### Phase 7.2: Song Modal Stacking Fix (INSERTED)

**Goal**: Fix modal navigation so clip selection overlays song search
**Depends on**: Phase 7
**Plans**: 1/1 complete (+ 1 FIX)

Plans:

- [x] 07.2-01: SongSearchScreen + ClipSelectionModal overlay
- [x] 07.2-01-FIX: UAT fixes (onboarding navigation + modal animation)

### Phase 7.3: Simplify Clip Selection Modal (INSERTED)

**Goal**: Simplify waveform scrubber - remove dual range handles, keep drag-to-seek
**Depends on**: Phase 7
**Plans**: 1/1 complete

Plans:

- [x] 07.3-01: Simplified waveform with drag-to-seek

### Phase 8: User Albums Display

**Goal**: Implement horizontal scroll bar for user-created albums
**Depends on**: Phase 5
**Plans**: 6/6 complete (+ 7 FIX + 1 ENH)

Plans:

- [x] 08-01: Album data layer (albumService.js with CRUD operations)
- [x] 08-02: Album display components (AlbumCard, AlbumBar, ProfileScreen integration)
- [x] 08-03: Album creation flow (CreateAlbumScreen, AlbumPhotoPickerScreen)
- [x] 08-04: Album grid view (AlbumGridScreen, cover photos, navigation)
- [x] 08-05: Album photo viewer (full-screen, swipe navigation, set cover, remove)
- [x] 08-06: Album management (rename, delete, change cover, AddToAlbumSheet)
- [x] 08-FIX1 through 08-FIX7: UAT fixes
- [x] 08-ENH1: Stacked card effect

### Phase 8.1: Grid Header Safe Area Fix (INSERTED)

**Goal**: Fix album grid view showing photos behind status bar when scrolling
**Depends on**: Phase 8
**Plans**: 1/1 complete

Plans:

- [x] 08.1-01: Safe area background for AlbumGridScreen + AlbumPhotoPickerScreen

### Phase 8.2: Album Creation Animation (INSERTED)

**Goal**: Add visual feedback animation when new album is created
**Depends on**: Phase 8.1
**Plans**: 1/1 complete

Plans:

- [x] 08.2-01: Scroll-to and scale bounce animation for new album

### Phase 9: Monthly Albums

**Goal**: Auto-generate and display monthly albums grouping all user photos by month
**Depends on**: Phase 5
**Plans**: 3/3 complete

Plans:

- [x] 09-01: Data layer + MonthlyAlbumCard component
- [x] 09-02: YearSection + MonthlyAlbumsSection with animations
- [x] 09-03: Grid view + ProfileScreen integration

### Phase 10: Empty Feed State UI Change

**Goal**: Implement contextual empty states that guide users toward meaningful actions
**Depends on**: Phase 9
**Plans**: 1/1 complete

Plans:

- [x] 10-01: Data layer + empty state components + FeedScreen integration

### Phase 11: Feed Reaction Emoji Enhancements

**Goal**: Curated 5-emoji rotation per photo with custom emoji picker
**Depends on**: Phase 10
**Plans**: 1/1 complete (+ 1 FIX)

Plans:

- [x] 11-01: Curated emoji infrastructure, hook updates, and UI integration
- [x] 11-01-FIX: UX refinements

### Phase 12: Own Snaps in Stories Bar

**Goal**: Display user's own journaled snaps in stories bar, allow comments but prevent self-reactions
**Depends on**: Phase 11
**Plans**: 1/1 complete

Plans:

- [x] 12-01: MeStoryCard component, getUserStoriesData service, disabled self-reactions

### Phase 13: Split Activity into Notifications & Friends

**Goal**: Separate activity page into notifications (heart icon) and friends list (friend icon)
**Depends on**: Phase 12
**Plans**: 2/2 complete

Plans:

- [x] 13-01: Feed header navigation icons
- [x] 13-02: Activity screen cleanup (notifications-only)

### Phase 14: Profile Field Character Limits

**Goal**: Enforce maximum character lengths for profile fields
**Depends on**: Phase 13
**Plans**: 1/1 complete

Plans:

- [x] 14-01: Input component enhancements + ProfileSetupScreen integration

### Phase 15: Friends Screen & Other Profiles

**Goal**: Refactor friends screen and wire up ability to view other peoples profile
**Depends on**: Phase 14
**Plans**: 3/3 complete (+ 2 FIX)

Plans:

- [x] 15-01: Unified Friends screen with Requests | Friends tabs
- [x] 15-02: Wire up profile navigation from avatar taps
- [x] 15-02-FIX, 15-02-FIX2: UAT fixes
- [x] 15-03: Universal avatar navigation throughout the app

### Phase 15.1: Profile Setup Cancel Flow (INSERTED)

**Goal**: Allow users to cancel profile setup and return to phone number input
**Depends on**: Phase 15
**Plans**: 1/1 complete

Plans:

- [x] 15.1-01: Cancel button with confirmation dialog + user doc deletion

### Phase 15.2: Modal State Preservation (INSERTED)

**Goal**: Preserve modal state when navigating to profiles from story/comment modals
**Depends on**: Phase 15
**Plans**: 1/1 complete (+ 2 FIX)

Plans:

- [x] 15.2-01: Modal state preservation infrastructure + deferred navigation
- [x] 15.2-01-FIX, 15.2-01-FIX2: Layered architecture fixes

### Phase 15.3: Modal Architecture Fix (INSERTED)

**Goal**: Fix modal stacking architecture and comment avatar navigation
**Depends on**: Phase 15.2
**Plans**: 2/2 complete

Plans:

- [x] 15.3-01: PhotoDetail navigation screen infrastructure
- [x] 15.3-02: FeedScreen integration with PhotoDetailScreen

### Phase 15.4: Story Viewed State Fix (INSERTED)

**Goal**: Restore story viewed tracking broken by Phase 15.3 navigation changes
**Depends on**: Phase 15.3
**Plans**: 1/1 complete (+ 3 FIX)

Plans:

- [x] 15.4-01: Fix closure capture bug and real-time reactions
- [x] 15.4-01-FIX, 15.4-02-FIX, 15.4-03-FIX: UAT fixes

### Phase 16: Color Constants Standardization

**Goal**: Standardize all colors to use constants, eliminate hardcoded values
**Depends on**: Phase 15.3
**Plans**: 10/10 complete

Plans:

- [x] 16-01 through 16-10: Color system foundation, screens, modals, components, documentation

### Phase 17: Nested Reply Comments

**Goal**: Reply to replies with @mention tagging, Instagram-style inline threading
**Depends on**: Phase 16
**Plans**: 2/2 complete

Plans:

- [x] 17-01: Reply infrastructure (service update + auto @mention insertion)
- [x] 17-02: @Mention rendering and scroll-to-comment navigation

### Phase 18: Content Visibility Duration

**Goal**: Implement visibility duration rules for stories (7 days) and feed posts (1 day)
**Depends on**: Phase 17
**Plans**: 1/1 complete (+ 1 FIX)

Plans:

- [x] 18-01: Server-side Firestore filtering for visibility duration
- [x] 18-01-FIX: UAT fixes

### Phase 19: Delete Account Fallback

**Goal**: Ensure delete account function works with 30-day grace period
**Depends on**: Phase 18
**Plans**: 5/5 complete

Plans:

- [x] 19-01: Scheduled deletion infrastructure
- [x] 19-02: Download all photos feature
- [x] 19-03: Redesigned DeleteAccountScreen with 30-day scheduling
- [x] 19-04: Grace period recovery
- [x] 19-05: Deletion reminder notification + deleted user handling

### Phase 20: Friend Suggestions via Contacts Sync

**Goal**: Suggest potential friends based on phone contacts
**Depends on**: Phase 19
**Plans**: 3/3 complete

Plans:

- [x] 20-01: Contact sync data layer
- [x] 20-02: ContactsSyncScreen + Onboarding integration
- [x] 20-03: Suggestions UI in Requests tab

### Phase 21: Remove/Block Friends

**Goal**: Add ability to remove or block friends with user reporting
**Depends on**: Phase 20
**Plans**: 4/4 complete

Plans:

- [x] 21-01: Block & Report Data Layer
- [x] 21-02: Menu Integration & Actions
- [x] 21-03: Report User Screen
- [x] 21-04: Block Enforcement

### Phase 22: Ability to Edit Profile

**Goal**: Edit profile screen for updating user info
**Depends on**: Phase 21
**Plans**: 2/2 complete

Plans:

- [x] 22-01: Data Layer + Settings Integration
- [x] 22-02: EditProfileScreen Implementation

### Phase 23: Photo Deletion & Archiving

**Goal**: Enable users to delete photos or remove from journal (archive)
**Depends on**: Phase 22
**Plans**: 2/2 complete

Plans:

- [x] 23-01: Photo Service Data Layer
- [x] 23-02: Photo management menu + auto-refresh

### Phase 23.1: Recently Deleted Photos (INSERTED)

**Goal**: 30-day grace period for photo deletion with recovery screen
**Depends on**: Phase 23
**Plans**: 2/2 complete

Plans:

- [x] 23.1-01: Soft Delete Infrastructure
- [x] 23.1-02: Recently Deleted UI

### Phase 24: Social Media Feature Audit

**Goal**: Full audit to ensure all expected social media app features are present
**Depends on**: Phase 23
**Plans**: 1/1 complete

Plans:

- [x] 24-01: Systematic feature verification and gap analysis

### Phase 25: Color Palette Selection & Customization

**Goal**: Theme selection and customization using color constants system
**Depends on**: Phase 24
**Plans**: 5/5 complete

Plans:

- [x] 25-01 through 25-05: Developer documentation and theme guides

### Phase 26: Feed Pull-to-Refresh & Loading Skeleton

**Goal**: Pulldown to refresh feed and loading skeleton updates
**Depends on**: Phase 25
**Plans**: 1/1 complete

Plans:

- [x] 26-01: Shimmer animation and fade-in transition

### Phase 27: Color Constants Convention Documentation

**Goal**: Document color constants requirement in CONVENTIONS.md
**Depends on**: Phase 26
**Plans**: 1/1 complete

Plans:

- [x] 27-01: Add Color System section to CONVENTIONS.md

### Phase 28: Blocked Users Management

**Goal**: Blocked users list UI
**Depends on**: Phase 27
**Plans**: 1/1 complete

Plans:

- [x] 28-01: BlockedUsersScreen with Settings integration

### Phase 29: Settings & Help Enhancements

**Goal**: Help link and app version display
**Depends on**: Phase 28
**Plans**: 1/1 complete

Plans:

- [x] 29-01: Help/Support email link + app version display

### Phase 30: Optimization and Performance Enhancements

**Goal**: App-wide performance improvements
**Depends on**: Phase 29
**Plans**: 5/5 complete

Plans:

- [x] 30-01 through 30-05: expo-image migration and performance verification

### Phase 31: Settings Section Headers

**Goal**: Add section headers to organize Settings page
**Depends on**: Phase 30
**Plans**: 1/1 complete

Plans:

- [x] 31-01: Add section headers to SettingsScreen

---

## Milestone Summary

**Decimal Phases:**

- Phase 3.1: Auth Input Field Fixes (inserted after Phase 3 for urgent bug fixes)
- Phase 4.1: Drag-Reorder Visual Feedback (inserted after Phase 4 for UX improvement)
- Phase 7.2: Song Modal Stacking Fix (inserted after Phase 7 for UAT issue)
- Phase 7.3: Simplify Clip Selection Modal (inserted after Phase 7 for UX simplification)
- Phase 8.1: Grid Header Safe Area Fix (inserted after Phase 8 for safe area bug)
- Phase 8.2: Album Creation Animation (inserted after Phase 8.1 for UX feedback)
- Phase 15.1: Profile Setup Cancel Flow (inserted after Phase 15 for cancel functionality)
- Phase 15.2: Modal State Preservation (inserted after Phase 15.1 for modal UX)
- Phase 15.3: Modal Architecture Fix (inserted after Phase 15.2 for navigation architecture)
- Phase 15.4: Story Viewed State Fix (inserted after Phase 15.3 for regression fix)
- Phase 23.1: Recently Deleted Photos (inserted after Phase 23 for soft delete)

**Key Decisions:**

- iTunes 30s previews for profile songs (Spotify SDK deprecated)
- Flat comment threading with @mentions (Instagram-style)
- 7-day story visibility, 1-day feed visibility
- Pure black (#000000) background for dark theme
- expo-image for performance optimization
- 30-day grace periods for account and photo deletion

**Issues Resolved:**

- ISS-002, ISS-003, ISS-006, ISS-007, ISS-008 closed during Phase 15.x
- Phone number backspace formatting bug
- Modal stacking architecture issues
- Story viewed state tracking regression
- White flash on navigation transitions

**Issues Deferred:**

- ISS-001: Optimize photo capture for full-screen display
- ISS-004: Comments sheet closes when navigating to profile
- ISS-005: Swipe up on photo to open comments
- ISS-011: Custom profile photo crop UI

**Technical Debt Incurred:**

- Some screens may need individual contentStyle additions for future navigation changes
- Contact sync batch size (30) is Firestore limit, may need pagination for very large contact lists

---

_For current project status, see .planning/ROADMAP.md_
